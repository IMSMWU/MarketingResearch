<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Chi-square test | Marketing Research</title>
  <meta name="description" content="An Introduction to Statistics Using R" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Chi-square test | Marketing Research" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to Statistics Using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Chi-square test | Marketing Research" />
  
  <meta name="twitter:description" content="An Introduction to Statistics Using R" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="hypothesis-testing.html"/>
<link rel="next" href="correlation.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Marketing Research</a></strong></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html"><i class="fa fa-check"></i>Course materials</a>
<ul>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#main-reference"><i class="fa fa-check"></i>Main reference</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#further-readings"><i class="fa fa-check"></i>Further readings</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#datacamp"><i class="fa fa-check"></i>DataCamp</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#other-web-resources"><i class="fa fa-check"></i>Other web-resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#how-to-download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> How to download and install R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#getting-help"><i class="fa fa-check"></i><b>1.2</b> Getting help</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#packages"><i class="fa fa-check"></i><b>1.4</b> Packages</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#a-typical-r-session"><i class="fa fa-check"></i><b>1.5</b> A typical R session</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>2</b> Data handling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-handling.html"><a href="data-handling.html#basic-data-handling"><i class="fa fa-check"></i><b>2.1</b> Basic data handling</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-handling.html"><a href="data-handling.html#creating-objects"><i class="fa fa-check"></i><b>2.1.1</b> Creating objects</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-handling.html"><a href="data-handling.html#data-types"><i class="fa fa-check"></i><b>2.1.2</b> Data types</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-handling.html"><a href="data-handling.html#data-structures"><i class="fa fa-check"></i><b>2.1.3</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-handling.html"><a href="data-handling.html#data-import-and-export"><i class="fa fa-check"></i><b>2.2</b> Data import and export</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-handling.html"><a href="data-handling.html#getting-data-for-this-course"><i class="fa fa-check"></i><b>2.2.1</b> Getting data for this course</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-handling.html"><a href="data-handling.html#import-data-created-by-other-software-packages"><i class="fa fa-check"></i><b>2.2.2</b> Import data created by other software packages</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-handling.html"><a href="data-handling.html#export-data"><i class="fa fa-check"></i><b>2.2.3</b> Export data</a></li>
<li class="chapter" data-level="2.2.4" data-path="data-handling.html"><a href="data-handling.html#import-data-from-the-web"><i class="fa fa-check"></i><b>2.2.4</b> Import data from the Web</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-handling.html"><a href="data-handling.html#summarizing-data"><i class="fa fa-check"></i><b>2.3</b> Summarizing data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-handling.html"><a href="data-handling.html#summary-statistics"><i class="fa fa-check"></i><b>2.3.1</b> Summary statistics</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-handling.html"><a href="data-handling.html#categorical-variables"><i class="fa fa-check"></i><b>2.3.2</b> Categorical variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-handling.html"><a href="data-handling.html#continuous-variables"><i class="fa fa-check"></i><b>2.3.3</b> Continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-handling.html"><a href="data-handling.html#data-visualization"><i class="fa fa-check"></i><b>2.4</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-handling.html"><a href="data-handling.html#categorical-variables-1"><i class="fa fa-check"></i><b>2.4.1</b> Categorical variables</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-handling.html"><a href="data-handling.html#continuous-variables-1"><i class="fa fa-check"></i><b>2.4.2</b> Continuous variables</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-handling.html"><a href="data-handling.html#saving-plots"><i class="fa fa-check"></i><b>2.4.3</b> Saving plots</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-handling.html"><a href="data-handling.html#additional-options"><i class="fa fa-check"></i><b>2.4.4</b> Additional options</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-handling.html"><a href="data-handling.html#writing-reports-using-r-markdown"><i class="fa fa-check"></i><b>2.5</b> Writing reports using R-Markdown</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-handling.html"><a href="data-handling.html#creating-a-new-r-markdown-document"><i class="fa fa-check"></i><b>2.5.1</b> Creating a new R-Markdown document</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-handling.html"><a href="data-handling.html#text-and-equations"><i class="fa fa-check"></i><b>2.5.2</b> Text and Equations</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-handling.html"><a href="data-handling.html#r-code"><i class="fa fa-check"></i><b>2.5.3</b> R-Code</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-handling.html"><a href="data-handling.html#latex-math"><i class="fa fa-check"></i><b>2.5.4</b> LaTeX Math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html"><i class="fa fa-check"></i><b>3</b> Introduction to Statistical Inference</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#if-we-knew-it-all"><i class="fa fa-check"></i><b>3.1</b> If we knew it all</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#sampling-from-a-known-population"><i class="fa fa-check"></i><b>3.1.1</b> Sampling from a known population</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>3.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>3.2</b> The Central Limit Theorem</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#using-what-we-actually-know"><i class="fa fa-check"></i><b>3.3</b> Using what we actually know</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#confidence-intervals-for-the-sample-mean"><i class="fa fa-check"></i><b>3.3.1</b> Confidence Intervals for the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>4</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-null-hypothesis"><i class="fa fa-check"></i><b>4.1.1</b> The null hypothesis</a></li>
<li class="chapter" data-level="4.1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-inference-on-a-sample"><i class="fa fa-check"></i><b>4.1.2</b> Statistical inference on a sample</a></li>
<li class="chapter" data-level="4.1.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#choosing-the-right-test"><i class="fa fa-check"></i><b>4.1.3</b> Choosing the right test</a></li>
<li class="chapter" data-level="4.1.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#summary-1"><i class="fa fa-check"></i><b>4.1.4</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chi-square-test.html"><a href="chi-square-test.html"><i class="fa fa-check"></i><b>5</b> Chi-square test</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chi-square-test.html"><a href="chi-square-test.html#confidence-intervals-for-proportions"><i class="fa fa-check"></i><b>5.1</b> Confidence intervals for proportions</a></li>
<li class="chapter" data-level="5.2" data-path="chi-square-test.html"><a href="chi-square-test.html#chi-square-test-1"><i class="fa fa-check"></i><b>5.2</b> Chi-square test</a></li>
<li class="chapter" data-level="5.3" data-path="chi-square-test.html"><a href="chi-square-test.html#sample-size-1"><i class="fa fa-check"></i><b>5.3</b> Sample size</a></li>
<li class="chapter" data-level="5.4" data-path="chi-square-test.html"><a href="chi-square-test.html#summary-2"><i class="fa fa-check"></i><b>5.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>6</b> Correlation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="correlation.html"><a href="correlation.html#correlation-coefficient"><i class="fa fa-check"></i><b>6.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="6.2" data-path="correlation.html"><a href="correlation.html#significance-testing"><i class="fa fa-check"></i><b>6.2</b> Significance testing</a></li>
<li class="chapter" data-level="6.3" data-path="correlation.html"><a href="correlation.html#summary-3"><i class="fa fa-check"></i><b>6.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="t-test.html"><a href="t-test.html"><i class="fa fa-check"></i><b>7</b> t-test</a>
<ul>
<li class="chapter" data-level="7.1" data-path="t-test.html"><a href="t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>7.1</b> One sample t-test</a></li>
<li class="chapter" data-level="7.2" data-path="t-test.html"><a href="t-test.html#comparing-two-means"><i class="fa fa-check"></i><b>7.2</b> Comparing two means</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="t-test.html"><a href="t-test.html#independent-means-t-test"><i class="fa fa-check"></i><b>7.2.1</b> Independent-means t-test</a></li>
<li class="chapter" data-level="7.2.2" data-path="t-test.html"><a href="t-test.html#dependent-means-t-test"><i class="fa fa-check"></i><b>7.2.2</b> Dependent-means t-test</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="t-test.html"><a href="t-test.html#summary-4"><i class="fa fa-check"></i><b>7.3</b> Summary</a></li>
<li class="chapter" data-level="7.4" data-path="t-test.html"><a href="t-test.html#further-considerations"><i class="fa fa-check"></i><b>7.4</b> Further considerations</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="t-test.html"><a href="t-test.html#type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>7.4.1</b> Type I and Type II Errors</a></li>
<li class="chapter" data-level="7.4.2" data-path="t-test.html"><a href="t-test.html#significance-level-sample-size-power-and-effect-size"><i class="fa fa-check"></i><b>7.4.2</b> Significance level, sample size, power, and effect size</a></li>
<li class="chapter" data-level="7.4.3" data-path="t-test.html"><a href="t-test.html#p-values-stopping-rules-and-p-hacking"><i class="fa fa-check"></i><b>7.4.3</b> P-values, stopping rules and p-hacking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>8</b> ANOVA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="anova.html"><a href="anova.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="anova.html"><a href="anova.html#decomposing-variance"><i class="fa fa-check"></i><b>8.2</b> Decomposing variance</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="anova.html"><a href="anova.html#total-sum-of-squares"><i class="fa fa-check"></i><b>8.2.1</b> Total sum of squares</a></li>
<li class="chapter" data-level="8.2.2" data-path="anova.html"><a href="anova.html#model-sum-of-squares"><i class="fa fa-check"></i><b>8.2.2</b> Model sum of squares</a></li>
<li class="chapter" data-level="8.2.3" data-path="anova.html"><a href="anova.html#residual-sum-of-squares"><i class="fa fa-check"></i><b>8.2.3</b> Residual sum of squares</a></li>
<li class="chapter" data-level="8.2.4" data-path="anova.html"><a href="anova.html#effect-strength"><i class="fa fa-check"></i><b>8.2.4</b> Effect strength</a></li>
<li class="chapter" data-level="8.2.5" data-path="anova.html"><a href="anova.html#test-of-significance"><i class="fa fa-check"></i><b>8.2.5</b> Test of significance</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="anova.html"><a href="anova.html#one-way-anova"><i class="fa fa-check"></i><b>8.3</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="anova.html"><a href="anova.html#basic-anova"><i class="fa fa-check"></i><b>8.3.1</b> Basic ANOVA</a></li>
<li class="chapter" data-level="8.3.2" data-path="anova.html"><a href="anova.html#post-hoc-tests"><i class="fa fa-check"></i><b>8.3.2</b> Post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="anova.html"><a href="anova.html#summary-5"><i class="fa fa-check"></i><b>8.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>9</b> Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regression.html"><a href="regression.html#regression-1"><i class="fa fa-check"></i><b>9.1</b> Regression</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="regression.html"><a href="regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>9.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="9.1.2" data-path="regression.html"><a href="regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>9.1.2</b> Multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regression.html"><a href="regression.html#potential-problems"><i class="fa fa-check"></i><b>9.2</b> Potential problems</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="regression.html"><a href="regression.html#outliers"><i class="fa fa-check"></i><b>9.2.1</b> Outliers</a></li>
<li class="chapter" data-level="9.2.2" data-path="regression.html"><a href="regression.html#influential-observations"><i class="fa fa-check"></i><b>9.2.2</b> Influential observations</a></li>
<li class="chapter" data-level="9.2.3" data-path="regression.html"><a href="regression.html#non-linearity"><i class="fa fa-check"></i><b>9.2.3</b> Non-linearity</a></li>
<li class="chapter" data-level="9.2.4" data-path="regression.html"><a href="regression.html#non-constant-error-variance"><i class="fa fa-check"></i><b>9.2.4</b> Non-constant error variance</a></li>
<li class="chapter" data-level="9.2.5" data-path="regression.html"><a href="regression.html#non-normally-distributed-errors"><i class="fa fa-check"></i><b>9.2.5</b> Non-normally distributed errors</a></li>
<li class="chapter" data-level="9.2.6" data-path="regression.html"><a href="regression.html#correlation-of-errors"><i class="fa fa-check"></i><b>9.2.6</b> Correlation of errors</a></li>
<li class="chapter" data-level="9.2.7" data-path="regression.html"><a href="regression.html#collinearity"><i class="fa fa-check"></i><b>9.2.7</b> Collinearity</a></li>
<li class="chapter" data-level="9.2.8" data-path="regression.html"><a href="regression.html#omitted-variables"><i class="fa fa-check"></i><b>9.2.8</b> Omitted Variables</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="regression.html"><a href="regression.html#categorical-predictors"><i class="fa fa-check"></i><b>9.3</b> Categorical predictors</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="regression.html"><a href="regression.html#two-categories"><i class="fa fa-check"></i><b>9.3.1</b> Two categories</a></li>
<li class="chapter" data-level="9.3.2" data-path="regression.html"><a href="regression.html#more-than-two-categories"><i class="fa fa-check"></i><b>9.3.2</b> More than two categories</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regression.html"><a href="regression.html#summary-6"><i class="fa fa-check"></i><b>9.4</b> Summary</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Marketing Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chi-square-test" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Chi-square test</h1>
<p>This chapter is primarily based on Field, A., Miles J., &amp; Field, Z. (2012): Discovering Statistics Using R. Sage Publications, <strong>chapter 18</strong>.</p>
<p>In some instances, you will be confronted with differences between proportions, rather than differences between means. For example, you may conduct an A/B-Test and wish to compare the conversion rates between two advertising campaigns. In this case, your data is binary (0 = no conversion, 1 = conversion) and the sampling distribution for such data is binomial. While binomial probabilities are difficult to calculate, we can use a Normal approximation to the binomial when <code>n</code> is large (&gt;100) and the true likelihood of a 1 is not too close to 0 or 1.</p>
<p>Let’s use an example: assume a call center where service agents call potential customers to sell a product. We consider two call center agents:</p>
<ul>
<li>Service agent 1 talks to 300 customers and gets 200 of them to buy (conversion rate=2/3)</li>
<li>Service agent 2 talks to 300 customers and gets 100 of them to buy (conversion rate=1/3)</li>
</ul>
<p>As always, we load the data first:</p>
<p><a href="./Code/10-categorical_data%20(1).R">You can download the corresponding R-Code here</a></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="chi-square-test.html#cb203-1" aria-hidden="true"></a>call_center &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/IMSMWU/Teaching/master/MRDA2017/call_center.dat&quot;</span>, </span>
<span id="cb203-2"><a href="chi-square-test.html#cb203-2" aria-hidden="true"></a>                          <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, </span>
<span id="cb203-3"><a href="chi-square-test.html#cb203-3" aria-hidden="true"></a>                          <span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="co">#read in data</span></span>
<span id="cb203-4"><a href="chi-square-test.html#cb203-4" aria-hidden="true"></a>call_center<span class="op">$</span>conversion &lt;-<span class="st"> </span><span class="kw">factor</span>(call_center<span class="op">$</span>conversion , <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>)) <span class="co">#convert to factor</span></span>
<span id="cb203-5"><a href="chi-square-test.html#cb203-5" aria-hidden="true"></a>call_center<span class="op">$</span>agent &lt;-<span class="st"> </span><span class="kw">factor</span>(call_center<span class="op">$</span>agent , <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;agent_1&quot;</span>, <span class="st">&quot;agent_2&quot;</span>)) <span class="co">#convert to factor</span></span></code></pre></div>
<p>Next, we create a table to check the relative frequencies:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="chi-square-test.html#cb204-1" aria-hidden="true"></a>rel_freq_table &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(call_center), <span class="dv">2</span>)) <span class="co">#conditional relative frequencies</span></span>
<span id="cb204-2"><a href="chi-square-test.html#cb204-2" aria-hidden="true"></a>rel_freq_table</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["agent"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["conversion"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["Freq"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"agent_1","2":"no","3":"0.3333333"},{"1":"agent_2","2":"no","3":"0.6666667"},{"1":"agent_1","2":"yes","3":"0.6666667"},{"1":"agent_2","2":"yes","3":"0.3333333"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We could also plot the data to visualize the frequencies using ggplot:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="chi-square-test.html#cb205-1" aria-hidden="true"></a><span class="kw">ggplot</span>(rel_freq_table, <span class="kw">aes</span>(<span class="dt">x =</span> agent, <span class="dt">y =</span> Freq, <span class="dt">fill =</span> conversion)) <span class="op">+</span><span class="st"> </span><span class="co">#plot data</span></span>
<span id="cb205-2"><a href="chi-square-test.html#cb205-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">.7</span>) <span class="op">+</span><span class="st"> </span><span class="co">#position</span></span>
<span id="cb205-3"><a href="chi-square-test.html#cb205-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="kw">round</span>(Freq<span class="op">*</span><span class="dv">100</span>,<span class="dv">0</span>),<span class="st">&quot;%&quot;</span>)), <span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">vjust =</span> <span class="fl">0.5</span>), <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="co">#add percentages</span></span>
<span id="cb205-4"><a href="chi-square-test.html#cb205-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Proportion of conversions&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Agent&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># specify axis labels</span></span>
<span id="cb205-5"><a href="chi-square-test.html#cb205-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-133"></span>
<img src="_main_files/figure-html/unnamed-chunk-133-1.png" alt="proportion of conversions per agent (stacked bar chart)" width="672" />
<p class="caption">
Figure 5.1: proportion of conversions per agent (stacked bar chart)
</p>
</div>
<p>… or using the <code>mosaicplot()</code> function:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="chi-square-test.html#cb206-1" aria-hidden="true"></a>contigency_table &lt;-<span class="st"> </span><span class="kw">table</span>(call_center)</span>
<span id="cb206-2"><a href="chi-square-test.html#cb206-2" aria-hidden="true"></a><span class="kw">mosaicplot</span>(contigency_table, <span class="dt">main =</span> <span class="st">&quot;Proportion of conversions by agent&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-134"></span>
<img src="_main_files/figure-html/unnamed-chunk-134-1.png" alt="proportion of conversions per agent (mosaic plot)" width="672" />
<p class="caption">
Figure 5.2: proportion of conversions per agent (mosaic plot)
</p>
</div>
<div id="confidence-intervals-for-proportions" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Confidence intervals for proportions</h2>
<p>Recall that we can use confidence intervals to determine the range of values that the true population parameter will take with a certain level of confidence based on the sample. Similar to the confidence interval for means, we can compute a confidence interval for proportions. The (1-<span class="math inline">\(\alpha\)</span>)% confidence interval for proportions is approximately</p>
<p><span class="math display">\[
CI = p\pm z_{1-\frac{\alpha}{2}}*\sqrt{\frac{p*(1-p)}{N}}
\]</span></p>
<p>where <span class="math inline">\(\sqrt{p(1-p)}\)</span> is the equivalent to the standard deviation in the formula for the confidence interval for means. Based on the equation, it is easy to compute the confidence intervals for the conversion rates of the call center agents:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="chi-square-test.html#cb207-1" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">subset</span>(call_center,agent<span class="op">==</span><span class="st">&quot;agent_1&quot;</span>)) <span class="co">#number of observations for agent 1</span></span>
<span id="cb207-2"><a href="chi-square-test.html#cb207-2" aria-hidden="true"></a>n2 &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">subset</span>(call_center,agent<span class="op">==</span><span class="st">&quot;agent_2&quot;</span>)) <span class="co">#number of observations for agent 1</span></span>
<span id="cb207-3"><a href="chi-square-test.html#cb207-3" aria-hidden="true"></a>n1_conv &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">subset</span>(call_center,agent<span class="op">==</span><span class="st">&quot;agent_1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>conversion<span class="op">==</span><span class="st">&quot;yes&quot;</span>)) <span class="co">#number of conversions for agent 1</span></span>
<span id="cb207-4"><a href="chi-square-test.html#cb207-4" aria-hidden="true"></a>n2_conv &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">subset</span>(call_center,agent<span class="op">==</span><span class="st">&quot;agent_2&quot;</span> <span class="op">&amp;</span><span class="st"> </span>conversion<span class="op">==</span><span class="st">&quot;yes&quot;</span>)) <span class="co">#number of conversions for agent 2</span></span>
<span id="cb207-5"><a href="chi-square-test.html#cb207-5" aria-hidden="true"></a>p1 &lt;-<span class="st"> </span>n1_conv<span class="op">/</span>n1  <span class="co">#proportion of conversions for agent 1</span></span>
<span id="cb207-6"><a href="chi-square-test.html#cb207-6" aria-hidden="true"></a>p2 &lt;-<span class="st"> </span>n2_conv<span class="op">/</span>n2  <span class="co">#proportion of conversions for agent 2</span></span>
<span id="cb207-7"><a href="chi-square-test.html#cb207-7" aria-hidden="true"></a></span>
<span id="cb207-8"><a href="chi-square-test.html#cb207-8" aria-hidden="true"></a>error1 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sqrt</span>((p1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p1))<span class="op">/</span>n1)</span>
<span id="cb207-9"><a href="chi-square-test.html#cb207-9" aria-hidden="true"></a>ci_lower1 &lt;-<span class="st"> </span>p1 <span class="op">-</span><span class="st"> </span>error1</span>
<span id="cb207-10"><a href="chi-square-test.html#cb207-10" aria-hidden="true"></a>ci_upper1 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span>error1</span>
<span id="cb207-11"><a href="chi-square-test.html#cb207-11" aria-hidden="true"></a>ci_lower1</span></code></pre></div>
<pre><code>## [1] 0.6133232</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="chi-square-test.html#cb209-1" aria-hidden="true"></a>ci_upper1</span></code></pre></div>
<pre><code>## [1] 0.7200101</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="chi-square-test.html#cb211-1" aria-hidden="true"></a>error2 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sqrt</span>((p2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p2))<span class="op">/</span>n2)</span>
<span id="cb211-2"><a href="chi-square-test.html#cb211-2" aria-hidden="true"></a>ci_lower2 &lt;-<span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>error2</span>
<span id="cb211-3"><a href="chi-square-test.html#cb211-3" aria-hidden="true"></a>ci_upper2 &lt;-<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>error2</span>
<span id="cb211-4"><a href="chi-square-test.html#cb211-4" aria-hidden="true"></a>ci_lower2</span></code></pre></div>
<pre><code>## [1] 0.2799899</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="chi-square-test.html#cb213-1" aria-hidden="true"></a>ci_upper2</span></code></pre></div>
<pre><code>## [1] 0.3866768</code></pre>
<p>Similar to testing for differences in means, we could also ask: Is agent 1 twice as likely as agent 2 to convert a customer? Or, to state it formally:</p>
<p><span class="math display">\[H_0: \pi_1=\pi_2 \\
H_1: \pi_1\ne \pi_2\]</span></p>
<p>where <span class="math inline">\(\pi\)</span> denotes the population parameter associated with the proportion in the respective population. One approach to test this is based on confidence intervals to estimate the difference between two populations. We can compute an approximate confidence interval for the difference between the proportion of successes in group 1 and group 2, as:</p>
<p><span class="math display">\[
CI = p_1-p_2\pm z_{1-\frac{\alpha}{2}}*\sqrt{\frac{p_1*(1-p_1)}{n_1}+\frac{p_2*(1-p_2)}{n_2}}
\]</span></p>
<p>If the confidence interval includes zero, then the data does not suggest a difference between the groups. Let’s compute the confidence interval for differences in the proportions by hand first:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="chi-square-test.html#cb215-1" aria-hidden="true"></a>ci_lower &lt;-<span class="st"> </span>p1 <span class="op">-</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sqrt</span>(p1<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p1)<span class="op">/</span>n1 <span class="op">+</span><span class="st"> </span>p2<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p2)<span class="op">/</span>n2) <span class="co">#95% CI lower bound</span></span>
<span id="cb215-2"><a href="chi-square-test.html#cb215-2" aria-hidden="true"></a>ci_upper &lt;-<span class="st"> </span>p1 <span class="op">-</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span><span class="kw">sqrt</span>(p1<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p1)<span class="op">/</span>n1 <span class="op">+</span><span class="st"> </span>p2<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p2)<span class="op">/</span>n2) <span class="co">#95% CI upper bound</span></span>
<span id="cb215-3"><a href="chi-square-test.html#cb215-3" aria-hidden="true"></a>ci_lower</span></code></pre></div>
<pre><code>## [1] 0.2578943</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="chi-square-test.html#cb217-1" aria-hidden="true"></a>ci_upper</span></code></pre></div>
<pre><code>## [1] 0.4087724</code></pre>
<p>Now we can see that the 95% confidence interval estimate of the difference between the proportion of conversions for agent 1 and the proportion of conversions for agent 2 is between 26% and 41%. This interval tells us the range of plausible values for the difference between the two population proportions. According to this interval, zero is not a plausible value for the difference (i.e., interval does not cross zero), so we reject the null hypothesis that the population proportions are the same.</p>
<p>Instead of computing the intervals by hand, we could also use the <code>prop.test()</code> function:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="chi-square-test.html#cb219-1" aria-hidden="true"></a><span class="kw">prop.test</span>(<span class="dt">x =</span> <span class="kw">c</span>(n1_conv, n2_conv), <span class="dt">n =</span> <span class="kw">c</span>(n1, n2), <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  2-sample test for equality of proportions with continuity correction
## 
## data:  c(n1_conv, n2_conv) out of c(n1, n2)
## X-squared = 65.34, df = 1, p-value = 0.0000000000000006303
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  0.2545610 0.4121057
## sample estimates:
##    prop 1    prop 2 
## 0.6666667 0.3333333</code></pre>
<p>Note that the <code>prop.test()</code> function uses a slightly different (more accurate) way to compute the confidence interval (Wilson’s score method is used). It is particularly a better approximation for smaller N. That’s why the confidence interval in the output slightly deviates from the manual computation above, which uses the Wald interval.</p>
<p>You can also see that the output from the <code>prop.test()</code> includes the results from a χ<sup>2</sup> test for the equality of proportions (which will be discussed below) and the associated p-value. Since the p-value is less than 0.05, we reject the null hypothesis of equal probability. Thus, the reporting would be:</p>
<p>The test showed that the conversion rate for agent 1 was higher by 33%. This difference is significant χ (1) = 70, p &lt; .05 (95% CI = [0.25,0.41]).</p>
</div>
<div id="chi-square-test-1" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Chi-square test</h2>
<p>In the previous section, we saw how we can compute the confidence interval for the difference between proportions to decide on whether or not to reject the null hypothesis. Whenever you would like to investigate the relationship between two categorical variables, the <span class="math inline">\(\chi^2\)</span> test may be used to test whether the variables are independent of each other. It achieves this by comparing the expected number of observations in a group to the actual values. Let’s continue with the example from the previous section. Under the null hypothesis, the two variables <em>agent</em> and <em>conversion</em> in our contingency table are independent (i.e., there is no relationship). This means that the frequency in each field will be roughly proportional to the probability of an observation being in that category, calculated under the assumption that they are independent. The difference between that expected quantity and the actual quantity can be used to construct the test statistic. The test statistic is computed as follows:</p>
<p><span class="math display">\[
\chi^2=\sum_{i=1}^{J}\frac{(f_o-f_e)^2}{f_e}
\]</span></p>
<p>where <span class="math inline">\(J\)</span> is the number of cells in the contingency table, <span class="math inline">\(f_o\)</span> are the observed cell frequencies and <span class="math inline">\(f_e\)</span> are the expected cell frequencies. The larger the differences, the larger the test statistic and the smaller the p-value.</p>
<p>The observed cell frequencies can easily be seen from the contingency table:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="chi-square-test.html#cb221-1" aria-hidden="true"></a>obs_cell1 &lt;-<span class="st"> </span>contigency_table[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb221-2"><a href="chi-square-test.html#cb221-2" aria-hidden="true"></a>obs_cell2 &lt;-<span class="st"> </span>contigency_table[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb221-3"><a href="chi-square-test.html#cb221-3" aria-hidden="true"></a>obs_cell3 &lt;-<span class="st"> </span>contigency_table[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb221-4"><a href="chi-square-test.html#cb221-4" aria-hidden="true"></a>obs_cell4 &lt;-<span class="st"> </span>contigency_table[<span class="dv">2</span>,<span class="dv">2</span>]</span></code></pre></div>
<p>The expected cell frequencies can be calculated as follows:</p>
<p><span class="math display">\[
f_e=\frac{(n_r*n_c)}{n}
\]</span></p>
<p>where <span class="math inline">\(n_r\)</span> are the total observed frequencies per row, <span class="math inline">\(n_c\)</span> are the total observed frequencies per column, and <span class="math inline">\(n\)</span> is the total number of observations. Thus, the expected cell frequencies under the assumption of independence can be calculated as:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="chi-square-test.html#cb222-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(call_center)</span>
<span id="cb222-2"><a href="chi-square-test.html#cb222-2" aria-hidden="true"></a>exp_cell1 &lt;-<span class="st"> </span>(<span class="kw">nrow</span>(call_center[call_center<span class="op">$</span>agent<span class="op">==</span><span class="st">&quot;agent_1&quot;</span>,])<span class="op">*</span><span class="kw">nrow</span>(call_center[call_center<span class="op">$</span>conversion<span class="op">==</span><span class="st">&quot;no&quot;</span>,]))<span class="op">/</span>n</span>
<span id="cb222-3"><a href="chi-square-test.html#cb222-3" aria-hidden="true"></a>exp_cell2 &lt;-<span class="st"> </span>(<span class="kw">nrow</span>(call_center[call_center<span class="op">$</span>agent<span class="op">==</span><span class="st">&quot;agent_1&quot;</span>,])<span class="op">*</span><span class="kw">nrow</span>(call_center[call_center<span class="op">$</span>conversion<span class="op">==</span><span class="st">&quot;yes&quot;</span>,]))<span class="op">/</span>n</span>
<span id="cb222-4"><a href="chi-square-test.html#cb222-4" aria-hidden="true"></a>exp_cell3 &lt;-<span class="st"> </span>(<span class="kw">nrow</span>(call_center[call_center<span class="op">$</span>agent<span class="op">==</span><span class="st">&quot;agent_2&quot;</span>,])<span class="op">*</span><span class="kw">nrow</span>(call_center[call_center<span class="op">$</span>conversion<span class="op">==</span><span class="st">&quot;no&quot;</span>,]))<span class="op">/</span>n</span>
<span id="cb222-5"><a href="chi-square-test.html#cb222-5" aria-hidden="true"></a>exp_cell4 &lt;-<span class="st"> </span>(<span class="kw">nrow</span>(call_center[call_center<span class="op">$</span>agent<span class="op">==</span><span class="st">&quot;agent_2&quot;</span>,])<span class="op">*</span><span class="kw">nrow</span>(call_center[call_center<span class="op">$</span>conversion<span class="op">==</span><span class="st">&quot;yes&quot;</span>,]))<span class="op">/</span>n</span></code></pre></div>
<p>To sum up, these are the expected cell frequencies</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="chi-square-test.html#cb223-1" aria-hidden="true"></a><span class="kw">data.frame</span>(<span class="dt">conversion_no =</span> <span class="kw">rbind</span>(exp_cell1,exp_cell3),<span class="dt">conversion_yes =</span> <span class="kw">rbind</span>(exp_cell2,exp_cell4), <span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;agent_1&quot;</span>,<span class="st">&quot;agent_2&quot;</span>)) </span></code></pre></div>
<pre><code>##         conversion_no conversion_yes
## agent_1           150            150
## agent_2           150            150</code></pre>
<p>… and these are the observed cell frequencies</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="chi-square-test.html#cb225-1" aria-hidden="true"></a><span class="kw">data.frame</span>(<span class="dt">conversion_no =</span> <span class="kw">rbind</span>(obs_cell1,obs_cell2),<span class="dt">conversion_yes =</span> <span class="kw">rbind</span>(obs_cell3,obs_cell4), <span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;agent_1&quot;</span>,<span class="st">&quot;agent_2&quot;</span>)) </span></code></pre></div>
<pre><code>##         conversion_no conversion_yes
## agent_1           100            200
## agent_2           200            100</code></pre>
<p>To obtain the test statistic, we simply plug the values into the formula:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="chi-square-test.html#cb227-1" aria-hidden="true"></a>chisq_cal &lt;-<span class="st">  </span><span class="kw">sum</span>(((obs_cell1 <span class="op">-</span><span class="st"> </span>exp_cell1)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>exp_cell1),</span>
<span id="cb227-2"><a href="chi-square-test.html#cb227-2" aria-hidden="true"></a>                  ((obs_cell2 <span class="op">-</span><span class="st"> </span>exp_cell2)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>exp_cell2),</span>
<span id="cb227-3"><a href="chi-square-test.html#cb227-3" aria-hidden="true"></a>                  ((obs_cell3 <span class="op">-</span><span class="st"> </span>exp_cell3)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>exp_cell3),</span>
<span id="cb227-4"><a href="chi-square-test.html#cb227-4" aria-hidden="true"></a>                  ((obs_cell4 <span class="op">-</span><span class="st"> </span>exp_cell4)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>exp_cell4))</span>
<span id="cb227-5"><a href="chi-square-test.html#cb227-5" aria-hidden="true"></a>chisq_cal</span></code></pre></div>
<pre><code>## [1] 66.66667</code></pre>
<p>The test statistic is <span class="math inline">\(\chi^2\)</span> distributed. The chi-square distribution is a non-symmetric distribution. Actually, there are many different chi-square distributions, one for each degree of freedom as show in the following figure.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-143"></span>
<img src="_main_files/figure-html/unnamed-chunk-143-1.png" alt="The chi-square distribution" width="672" />
<p class="caption">
Figure 5.3: The chi-square distribution
</p>
</div>
<p>You can see that as the degrees of freedom increase, the chi-square curve approaches a normal distribution. To find the critical value, we need to specify the corresponding degrees of freedom, given by:</p>
<p><span class="math display">\[
df=(r-1)*(c-1)
\]</span></p>
<p>where <span class="math inline">\(r\)</span> is the number of rows and <span class="math inline">\(c\)</span> is the number of columns in the contingency table. Recall that degrees of freedom are generally the number of values that can vary freely when calculating a statistic. In a 2 by 2 table as in our case, we have 2 variables (or two samples) with 2 levels and in each one we have 1 that vary freely. Hence, in our example the degrees of freedom can be calculated as:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="chi-square-test.html#cb229-1" aria-hidden="true"></a>df &lt;-<span class="st">  </span>(<span class="kw">nrow</span>(contigency_table) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">ncol</span>(contigency_table) <span class="dv">-1</span>)</span>
<span id="cb229-2"><a href="chi-square-test.html#cb229-2" aria-hidden="true"></a>df</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Now, we can derive the critical value given the degrees of freedom and the level of confidence using the <code>qchisq()</code> function and test if the calculated test statistic is larger than the critical value:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="chi-square-test.html#cb231-1" aria-hidden="true"></a>chisq_crit &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.95</span>, df)</span>
<span id="cb231-2"><a href="chi-square-test.html#cb231-2" aria-hidden="true"></a>chisq_crit</span></code></pre></div>
<pre><code>## [1] 3.841459</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="chi-square-test.html#cb233-1" aria-hidden="true"></a>chisq_cal <span class="op">&gt;</span><span class="st"> </span>chisq_crit</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-146"></span>
<img src="_main_files/figure-html/unnamed-chunk-146-1.png" alt="Visual depiction of the test result" width="672" />
<p class="caption">
Figure 5.4: Visual depiction of the test result
</p>
</div>
<p>We could also compute the p-value using the <code>pchisq()</code> function, which tells us the probability of the observed cell frequencies if the null hypothesis was true (i.e., there was no association):</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="chi-square-test.html#cb235-1" aria-hidden="true"></a>p_val &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(chisq_cal,df)</span>
<span id="cb235-2"><a href="chi-square-test.html#cb235-2" aria-hidden="true"></a>p_val</span></code></pre></div>
<pre><code>## [1] 0.0000000000000003330669</code></pre>
<p>The test statistic can also be calculated in R directly on the contingency table with the function <code>chisq.test()</code>.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="chi-square-test.html#cb237-1" aria-hidden="true"></a><span class="kw">chisq.test</span>(contigency_table, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  contigency_table
## X-squared = 66.667, df = 1, p-value = 0.0000000000000003215</code></pre>
<p>Since the p-value is smaller than 0.05 (i.e., the calculated test statistic is larger than the critical value), we reject H<sub>0</sub> that the two variables are independent.</p>
<p>Note that the test statistic is sensitive to the sample size. To see this, let’s assume that we have a sample of 100 observations instead of 1000 observations:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="chi-square-test.html#cb239-1" aria-hidden="true"></a><span class="kw">chisq.test</span>(contigency_table<span class="op">/</span><span class="dv">10</span>, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  contigency_table/10
## X-squared = 6.6667, df = 1, p-value = 0.009823</code></pre>
<p>You can see that even though the proportions haven’t changed, the test is insignificant now. The following equation lets you compute a measure of the effect size, which is insensitive to sample size:</p>
<p><span class="math display">\[
\phi=\sqrt{\frac{\chi^2}{n}}
\]</span></p>
<p>The following guidelines are used to determine the magnitude of the effect size (Cohen, 1988):</p>
<ul>
<li>0.1 (small effect)</li>
<li>0.3 (medium effect)</li>
<li>0.5 (large effect)</li>
</ul>
<p>In our example, we can compute the effect sizes for the large and small samples as follows:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="chi-square-test.html#cb241-1" aria-hidden="true"></a>test_stat &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(contigency_table, <span class="dt">correct =</span> <span class="ot">FALSE</span>)<span class="op">$</span>statistic</span>
<span id="cb241-2"><a href="chi-square-test.html#cb241-2" aria-hidden="true"></a>phi1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(test_stat<span class="op">/</span>n)</span>
<span id="cb241-3"><a href="chi-square-test.html#cb241-3" aria-hidden="true"></a>test_stat &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(contigency_table<span class="op">/</span><span class="dv">10</span>, <span class="dt">correct =</span> <span class="ot">FALSE</span>)<span class="op">$</span>statistic</span>
<span id="cb241-4"><a href="chi-square-test.html#cb241-4" aria-hidden="true"></a>phi2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(test_stat<span class="op">/</span>(n<span class="op">/</span><span class="dv">10</span>))</span>
<span id="cb241-5"><a href="chi-square-test.html#cb241-5" aria-hidden="true"></a>phi1</span></code></pre></div>
<pre><code>## X-squared 
## 0.3333333</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="chi-square-test.html#cb243-1" aria-hidden="true"></a>phi2</span></code></pre></div>
<pre><code>## X-squared 
## 0.3333333</code></pre>
<p>You can see that the statistic is insensitive to the sample size.</p>
<p>Note that the Φ coefficient is appropriate for two dichotomous variables (resulting from a 2 x 2 table as above). If any your nominal variables has more than two categories, Cramér’s V should be used instead:</p>
<p><span class="math display">\[
V=\sqrt{\frac{\chi^2}{n*df_{min}}}
\]</span></p>
<p>where <span class="math inline">\(df_{min}\)</span> refers to the degrees of freedom associated with the variable that has fewer categories (e.g., if we have two nominal variables with 3 and 4 categories, <span class="math inline">\(df_{min}\)</span> would be 3 - 1 = 2). The degrees of freedom need to be taken into account when judging the magnitude of the effect sizes (see e.g., <a href="http://www.real-statistics.com/chi-square-and-f-distributions/effect-size-chi-square/" target="_blank">here</a>).</p>
<p>Note that the <code>correct = FALSE</code> argument above ensures that the test statistic is computed in the same way as we have done by hand above. By default, <code>chisq.test()</code> applies a correction to prevent overestimation of statistical significance for small data (called the Yates’ correction). The correction is implemented by subtracting the value 0.5 from the computed difference between the observed and expected cell counts in the numerator of the test statistic. This means that the calculated test statistic will be smaller (i.e., more conservative). Although the adjustment may go too far in some instances, you should generally rely on the adjusted results, which can be computed as follows:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="chi-square-test.html#cb245-1" aria-hidden="true"></a><span class="kw">chisq.test</span>(contigency_table)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  contigency_table
## X-squared = 65.34, df = 1, p-value = 0.0000000000000006303</code></pre>
<p>As you can see, the results don’t change much in our example, since the differences between the observed and expected cell frequencies are fairly large relative to the correction.</p>
<p>Caution is warranted when the cell counts in the contingency table are small. The usual rule of thumb is that all cell counts should be at least 5 (this may be a little too stringent though). When some cell counts are too small, you can use Fisher’s exact test using the <code>fisher.test()</code> function.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="chi-square-test.html#cb247-1" aria-hidden="true"></a><span class="kw">fisher.test</span>(contigency_table)</span></code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  contigency_table
## p-value = 0.0000000000000003391
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.1754685 0.3560568
## sample estimates:
## odds ratio 
##  0.2506258</code></pre>
<p>The Fisher test, while more conservative, also shows a significant difference between the proportions (p &lt; 0.05). This is not surprising since the cell counts in our example are fairly large.</p>
</div>
<div id="sample-size-1" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Sample size</h2>
<p>To <strong>calculate the required sample size</strong> when comparing proportions, the <code>power.prop.test()</code> function can be used. For example, we could ask how large our sample needs to be if we would like to compare two groups with conversion rates of 2% and 2.5%, respectively using the conventional settings for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="chi-square-test.html#cb249-1" aria-hidden="true"></a><span class="kw">power.prop.test</span>(<span class="dt">p1=</span><span class="fl">0.02</span>,<span class="dt">p2=</span><span class="fl">0.025</span>,<span class="dt">sig.level=</span><span class="fl">0.05</span>,<span class="dt">power=</span><span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>## 
##      Two-sample comparison of proportions power calculation 
## 
##               n = 13808.92
##              p1 = 0.02
##              p2 = 0.025
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p>The output tells us that we need 13809 observations per group to detect a difference of the desired size.</p>
</div>
<div id="summary-2" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Summary</h2>
<ul>
<li><p>Confidence interval for proportions: the interval that shows the range of plausible values for the difference between the two population proportions. If the interval does not cross zero, then zero is not a plausible value for the difference between two proportions, and we reject the null hypothesis that the population proportions are the same.</p></li>
<li><p>Application of the Chi-square test: when there are 2 categorical variables (ordinal or nominal). In our example: conversion (yes or no) and agent (1 or 2).</p></li>
<li><p>Hypothesis: Is there an association between categorical variable X (e.g. conversion) and categorical variable Y (e.g. agent)?</p>
<p>H0: There is no association between the two variables.<br />
H1: There is an association between the two variables.</p></li>
<li><p>Interpretation: If we find an association between two variables (p &lt; 0.05), we can conclude that the propotion of conversions to proportion of non-conversions between agent 1 and agent 2 significantly differ from each other.</p></li>
<li><p>Example of application in marketing: Marketing department of a firm producing toilet paper is interested in studying the consumer behavior in the context of purchase decision. The company is planing to launch a high quality, super soft toilet paper, but beforehand they decided to conduct a research. They are interested in knowing whether the income level of their consumers influence their choice of the toilet paper quality or not. Currently there are 4 income categories the comapany’s consumers are assigned to, and 4 different levels of toilet paper quality (4x4 table).</p></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hypothesis-testing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
