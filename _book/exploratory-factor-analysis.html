<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>7 Exploratory factor analysis | Marketing Research Design &amp; Analysis 2019</title>
  <meta name="description" content="An Introduction to Statistics Using R">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="7 Exploratory factor analysis | Marketing Research Design &amp; Analysis 2019" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An Introduction to Statistics Using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Exploratory factor analysis | Marketing Research Design &amp; Analysis 2019" />
  
  <meta name="twitter:description" content="An Introduction to Statistics Using R" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="prev" href="regression.html">
<link rel="next" href="appendix.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">MRDA 2019</a></strong></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html"><i class="fa fa-check"></i>Course materials</a><ul>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#main-reference"><i class="fa fa-check"></i>Main reference</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#further-readings"><i class="fa fa-check"></i>Further readings</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#datacamp"><i class="fa fa-check"></i>DataCamp</a></li>
<li class="chapter" data-level="" data-path="course-materials.html"><a href="course-materials.html#other-web-resources"><i class="fa fa-check"></i>Other web-resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#how-to-download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> How to download and install R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#getting-help"><i class="fa fa-check"></i><b>1.2</b> Getting help</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#packages"><i class="fa fa-check"></i><b>1.4</b> Packages</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#a-typical-r-session"><i class="fa fa-check"></i><b>1.5</b> A typical R session</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>2</b> Data handling</a><ul>
<li class="chapter" data-level="2.1" data-path="data-handling.html"><a href="data-handling.html#basic-data-handling"><i class="fa fa-check"></i><b>2.1</b> Basic data handling</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-handling.html"><a href="data-handling.html#creating-objects"><i class="fa fa-check"></i><b>2.1.1</b> Creating objects</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-handling.html"><a href="data-handling.html#data-types"><i class="fa fa-check"></i><b>2.1.2</b> Data types</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-handling.html"><a href="data-handling.html#data-structures"><i class="fa fa-check"></i><b>2.1.3</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-handling.html"><a href="data-handling.html#advanced-data-handling"><i class="fa fa-check"></i><b>2.2</b> Advanced data handling</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-handling.html"><a href="data-handling.html#the-dplyr-package"><i class="fa fa-check"></i><b>2.2.1</b> The dplyr package</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-handling.html"><a href="data-handling.html#dealing-with-strings"><i class="fa fa-check"></i><b>2.2.2</b> Dealing with strings</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-handling.html"><a href="data-handling.html#case-study"><i class="fa fa-check"></i><b>2.2.3</b> Case study</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-handling.html"><a href="data-handling.html#data-import-and-export"><i class="fa fa-check"></i><b>2.3</b> Data import and export</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-handling.html"><a href="data-handling.html#getting-data-for-this-course"><i class="fa fa-check"></i><b>2.3.1</b> Getting data for this course</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-handling.html"><a href="data-handling.html#import-data-created-by-other-software-packages"><i class="fa fa-check"></i><b>2.3.2</b> Import data created by other software packages</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-handling.html"><a href="data-handling.html#export-data"><i class="fa fa-check"></i><b>2.3.3</b> Export data</a></li>
<li class="chapter" data-level="2.3.4" data-path="data-handling.html"><a href="data-handling.html#import-data-from-the-web"><i class="fa fa-check"></i><b>2.3.4</b> Import data from the Web</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>3</b> Summarizing data</a><ul>
<li class="chapter" data-level="3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#summary-statistics"><i class="fa fa-check"></i><b>3.1</b> Summary statistics</a><ul>
<li class="chapter" data-level="3.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables"><i class="fa fa-check"></i><b>3.1.1</b> Categorical variables</a></li>
<li class="chapter" data-level="3.1.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables"><i class="fa fa-check"></i><b>3.1.2</b> Continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#data-visualization"><i class="fa fa-check"></i><b>3.2</b> Data visualization</a><ul>
<li class="chapter" data-level="3.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables-1"><i class="fa fa-check"></i><b>3.2.1</b> Categorical variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables-1"><i class="fa fa-check"></i><b>3.2.2</b> Continuous variables</a></li>
<li class="chapter" data-level="3.2.3" data-path="summarizing-data.html"><a href="summarizing-data.html#saving-plots"><i class="fa fa-check"></i><b>3.2.3</b> Saving plots</a></li>
<li class="chapter" data-level="3.2.4" data-path="summarizing-data.html"><a href="summarizing-data.html#additional-options"><i class="fa fa-check"></i><b>3.2.4</b> Additional options</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="summarizing-data.html"><a href="summarizing-data.html#writing-reports-using-r-markdown"><i class="fa fa-check"></i><b>3.3</b> Writing reports using R-Markdown</a><ul>
<li class="chapter" data-level="3.3.1" data-path="summarizing-data.html"><a href="summarizing-data.html#creating-a-new-r-markdown-document"><i class="fa fa-check"></i><b>3.3.1</b> Creating a new R-Markdown document</a></li>
<li class="chapter" data-level="3.3.2" data-path="summarizing-data.html"><a href="summarizing-data.html#text-and-equations"><i class="fa fa-check"></i><b>3.3.2</b> Text and Equations</a></li>
<li class="chapter" data-level="3.3.3" data-path="summarizing-data.html"><a href="summarizing-data.html#r-code"><i class="fa fa-check"></i><b>3.3.3</b> R-Code</a></li>
<li class="chapter" data-level="3.3.4" data-path="summarizing-data.html"><a href="summarizing-data.html#latex-math"><i class="fa fa-check"></i><b>3.3.4</b> LaTeX Math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Introduction to Statistical Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#if-we-knew-it-all"><i class="fa fa-check"></i><b>4.1</b> If we knew it all</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#sampling-from-a-known-population"><i class="fa fa-check"></i><b>4.1.1</b> Sampling from a known population</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>4.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>4.2</b> The Central Limit Theorem</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#using-what-we-actually-know"><i class="fa fa-check"></i><b>4.3</b> Using what we actually know</a><ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#confidence-intervals-for-the-sample-mean"><i class="fa fa-check"></i><b>4.3.1</b> Confidence Intervals for the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-statistical-inference.html"><a href="introduction-to-statistical-inference.html#summary"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>5</b> Hypothesis testing</a><ul>
<li class="chapter" data-level="5.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a><ul>
<li class="chapter" data-level="5.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-null-hypothesis"><i class="fa fa-check"></i><b>5.1.1</b> The null hypothesis</a></li>
<li class="chapter" data-level="5.1.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-inference-on-a-sample"><i class="fa fa-check"></i><b>5.1.2</b> Statistical inference on a sample</a></li>
<li class="chapter" data-level="5.1.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#choosing-the-right-test"><i class="fa fa-check"></i><b>5.1.3</b> Choosing the right test</a></li>
<li class="chapter" data-level="5.1.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#summary-1"><i class="fa fa-check"></i><b>5.1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>5.2</b> One sample t-test</a></li>
<li class="chapter" data-level="5.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#comparing-two-means"><i class="fa fa-check"></i><b>5.3</b> Comparing two means</a><ul>
<li class="chapter" data-level="5.3.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#independent-means-t-test"><i class="fa fa-check"></i><b>5.3.1</b> Independent-means t-test</a></li>
<li class="chapter" data-level="5.3.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#dependent-means-t-test"><i class="fa fa-check"></i><b>5.3.2</b> Dependent-means t-test</a></li>
<li class="chapter" data-level="5.3.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#further-considerations"><i class="fa fa-check"></i><b>5.3.3</b> Further considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#comparing-several-means"><i class="fa fa-check"></i><b>5.4</b> Comparing several means</a><ul>
<li class="chapter" data-level="5.4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction-1"><i class="fa fa-check"></i><b>5.4.1</b> Introduction</a></li>
<li class="chapter" data-level="5.4.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#decomposing-variance"><i class="fa fa-check"></i><b>5.4.2</b> Decomposing variance</a></li>
<li class="chapter" data-level="5.4.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-way-anova"><i class="fa fa-check"></i><b>5.4.3</b> One-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#non-parametric-tests"><i class="fa fa-check"></i><b>5.5</b> Non-parametric tests</a><ul>
<li class="chapter" data-level="5.5.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#mann-whitney-u-test-a.k.a.-wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>5.5.1</b> Mann-Whitney U Test (a.k.a. Wilcoxon rank-sum test)</a></li>
<li class="chapter" data-level="5.5.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.5.2</b> Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="5.5.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>5.5.3</b> Kruskal-Wallis test</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#categorical-data"><i class="fa fa-check"></i><b>5.6</b> Categorical data</a><ul>
<li class="chapter" data-level="5.6.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-for-proportions"><i class="fa fa-check"></i><b>5.6.1</b> Confidence intervals for proportions</a></li>
<li class="chapter" data-level="5.6.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi-square-test"><i class="fa fa-check"></i><b>5.6.2</b> Chi-square test</a></li>
<li class="chapter" data-level="5.6.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#sample-size-1"><i class="fa fa-check"></i><b>5.6.3</b> Sample size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="regression.html"><a href="regression.html#correlation"><i class="fa fa-check"></i><b>6.1</b> Correlation</a><ul>
<li class="chapter" data-level="6.1.1" data-path="regression.html"><a href="regression.html#correlation-coefficient"><i class="fa fa-check"></i><b>6.1.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="6.1.2" data-path="regression.html"><a href="regression.html#significance-testing"><i class="fa fa-check"></i><b>6.1.2</b> Significance testing</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regression.html"><a href="regression.html#regression-1"><i class="fa fa-check"></i><b>6.2</b> Regression</a><ul>
<li class="chapter" data-level="6.2.1" data-path="regression.html"><a href="regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.2.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="6.2.2" data-path="regression.html"><a href="regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.2.2</b> Multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regression.html"><a href="regression.html#potential-problems"><i class="fa fa-check"></i><b>6.3</b> Potential problems</a><ul>
<li class="chapter" data-level="6.3.1" data-path="regression.html"><a href="regression.html#outliers"><i class="fa fa-check"></i><b>6.3.1</b> Outliers</a></li>
<li class="chapter" data-level="6.3.2" data-path="regression.html"><a href="regression.html#influential-observations"><i class="fa fa-check"></i><b>6.3.2</b> Influential observations</a></li>
<li class="chapter" data-level="6.3.3" data-path="regression.html"><a href="regression.html#non-linearity"><i class="fa fa-check"></i><b>6.3.3</b> Non-linearity</a></li>
<li class="chapter" data-level="6.3.4" data-path="regression.html"><a href="regression.html#non-constant-error-variance"><i class="fa fa-check"></i><b>6.3.4</b> Non-constant error variance</a></li>
<li class="chapter" data-level="6.3.5" data-path="regression.html"><a href="regression.html#non-normally-distributed-errors"><i class="fa fa-check"></i><b>6.3.5</b> Non-normally distributed errors</a></li>
<li class="chapter" data-level="6.3.6" data-path="regression.html"><a href="regression.html#correlation-of-errors"><i class="fa fa-check"></i><b>6.3.6</b> Correlation of errors</a></li>
<li class="chapter" data-level="6.3.7" data-path="regression.html"><a href="regression.html#collinearity"><i class="fa fa-check"></i><b>6.3.7</b> Collinearity</a></li>
<li class="chapter" data-level="6.3.8" data-path="regression.html"><a href="regression.html#omitted-variables"><i class="fa fa-check"></i><b>6.3.8</b> Omitted Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="regression.html"><a href="regression.html#categorical-predictors"><i class="fa fa-check"></i><b>6.4</b> Categorical predictors</a><ul>
<li class="chapter" data-level="6.4.1" data-path="regression.html"><a href="regression.html#two-categories"><i class="fa fa-check"></i><b>6.4.1</b> Two categories</a></li>
<li class="chapter" data-level="6.4.2" data-path="regression.html"><a href="regression.html#more-than-two-categories"><i class="fa fa-check"></i><b>6.4.2</b> More than two categories</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="regression.html"><a href="regression.html#extensions-of-the-linear-model"><i class="fa fa-check"></i><b>6.5</b> Extensions of the linear model</a><ul>
<li class="chapter" data-level="6.5.1" data-path="regression.html"><a href="regression.html#interaction-effects"><i class="fa fa-check"></i><b>6.5.1</b> Interaction effects</a></li>
<li class="chapter" data-level="6.5.2" data-path="regression.html"><a href="regression.html#non-linear-relationships"><i class="fa fa-check"></i><b>6.5.2</b> Non-linear relationships</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="regression.html"><a href="regression.html#logistic-regression"><i class="fa fa-check"></i><b>6.6</b> Logistic regression</a><ul>
<li class="chapter" data-level="6.6.1" data-path="regression.html"><a href="regression.html#motivation-and-intuition"><i class="fa fa-check"></i><b>6.6.1</b> Motivation and intuition</a></li>
<li class="chapter" data-level="6.6.2" data-path="regression.html"><a href="regression.html#technical-details-of-the-model"><i class="fa fa-check"></i><b>6.6.2</b> Technical details of the model</a></li>
<li class="chapter" data-level="6.6.3" data-path="regression.html"><a href="regression.html#estimation-in-r"><i class="fa fa-check"></i><b>6.6.3</b> Estimation in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html"><i class="fa fa-check"></i><b>7</b> Exploratory factor analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#steps-in-factor-analysis"><i class="fa fa-check"></i><b>7.2</b> Steps in factor analysis</a><ul>
<li class="chapter" data-level="7.2.1" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#are-the-assumptions-satisfied"><i class="fa fa-check"></i><b>7.2.1</b> Are the assumptions satisfied?</a></li>
<li class="chapter" data-level="7.2.2" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#deriving-factors"><i class="fa fa-check"></i><b>7.2.2</b> Deriving factors</a></li>
<li class="chapter" data-level="7.2.3" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#factor-interpretation"><i class="fa fa-check"></i><b>7.2.3</b> Factor interpretation</a></li>
<li class="chapter" data-level="7.2.4" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#creating-new-variables"><i class="fa fa-check"></i><b>7.2.4</b> Creating new variables</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html#reliability-analysis"><i class="fa fa-check"></i><b>7.3</b> Reliability analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>8</b> Appendix</a><ul>
<li class="chapter" data-level="8.1" data-path="appendix.html"><a href="appendix.html#random-variables-probability-distributions"><i class="fa fa-check"></i><b>8.1</b> Random Variables &amp; Probability Distributions</a><ul>
<li class="chapter" data-level="8.1.1" data-path="appendix.html"><a href="appendix.html#random-variables"><i class="fa fa-check"></i><b>8.1.1</b> Random variables</a></li>
<li class="chapter" data-level="8.1.2" data-path="appendix.html"><a href="appendix.html#probability-distributions"><i class="fa fa-check"></i><b>8.1.2</b> Probability Distributions</a></li>
<li class="chapter" data-level="8.1.3" data-path="appendix.html"><a href="appendix.html#appendix-1"><i class="fa fa-check"></i><b>8.1.3</b> Appendix</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="appendix.html"><a href="appendix.html#regression-2"><i class="fa fa-check"></i><b>8.2</b> Regression</a><ul>
<li class="chapter" data-level="8.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression"><i class="fa fa-check"></i><b>8.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-1"><i class="fa fa-check"></i><b>8.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="assignments.html"><a href="assignments.html"><i class="fa fa-check"></i><b>9</b> Assignments</a><ul>
<li class="chapter" data-level="9.1" data-path="assignments.html"><a href="assignments.html#assignment-2-hypothesis-testing"><i class="fa fa-check"></i><b>9.1</b> Assignment 2 (Hypothesis Testing)</a></li>
<li class="chapter" data-level="9.2" data-path="assignments.html"><a href="assignments.html#assignment-3-hypothesis-testing-2"><i class="fa fa-check"></i><b>9.2</b> Assignment 3 (Hypothesis Testing 2)</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Marketing Research Design &amp; Analysis 2019</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploratory-factor-analysis" class="section level1">
<h1><span class="header-section-number">7</span> Exploratory factor analysis</h1>
<p>This chapter is primarily based on</p>
<ul>
<li>Field, A., Miles J., &amp; Field, Z. (2012): Discovering Statistics Using R. Sage Publications, <strong>chapter 17</strong></li>
<li>Malhotra, N. K.(2010). Marketing Research: An Applied Orientation (6th. ed.). Prentice Hall. <strong>chapter 19</strong></li>
</ul>
<p><a href="./Code/12-pca.R">You can download the corresponding R-Code here</a></p>
<div id="introduction-2" class="section level2">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p>In this chapter, we will focus on exploratory factor analysis.</p>
<p>Generally, factor analysis is a class of procedures used for data reduction or summarization. It is an <strong>interdependence technique</strong>, meaning that there is
no distinction between dependent and independent variables and all variables are considered simultaneously. In <strong>exploratory factor analysis</strong>, specific hypotheses about how many factors will emerge, and what items these factors will comprise are not requires (as opposed to confirmatory factor analysis). Principal Components Analysis (PCA) is one of the most frequently used techniques. The goals are …</p>
<ul>
<li>To identify underlying dimensions, or factors, that explain the correlations among a set of variables</li>
<li>To identify a new, smaller set of uncorrelated variables to replace the original set of correlated variables in subsequent multivariate analysis (e.g., regression analysis, t-test, etc.)</li>
</ul>
<p>To see what this means, let’s use a simple example. Say, you wanted to explain the motives underlying the purchasing of toothpaste. You come up with six items that represent different motives of purchasing toothpaste:</p>
<ul>
<li><strong>Item 1</strong>: It is important to buy toothpaste that prevents cavities.</li>
<li><strong>Item 2</strong>: I like a toothpaste that gives shiny teeth.</li>
<li><strong>Item 3</strong>: A toothpaste should strengthen your gums.</li>
<li><strong>Item 4</strong>: I prefer a toothpaste that freshens breath.</li>
<li><strong>Item 5</strong>: Prevention of tooth decay should not be an important benefit offered by a toothpaste.</li>
<li><strong>Item 6</strong>: The most important consideration in buying a toothpaste is attractive teeth.</li>
</ul>
<p>Let’s assume you collect data from 30 respondents and you use 7-point itemized rating scales to measure the extent of agreement to each of these statements. This is the data that you have collected:</p>
<pre class="sourceCode r"><code class="sourceCode r">factor_analysis &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/IMSMWU/Teaching/master/MRDA2017/toothpaste.dat&quot;</span>, 
                          <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, 
                          <span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="co">#read in data</span>
<span class="kw">str</span>(factor_analysis) <span class="co">#inspect data</span></code></pre>
<pre><code>## &#39;data.frame&#39;:    30 obs. of  6 variables:
##  $ prevent_cavities: int  7 1 6 4 1 6 5 6 3 2 ...
##  $ shiny_teeth     : int  3 3 2 5 2 3 3 4 4 6 ...
##  $ strengthen_gum  : int  6 2 7 4 2 6 6 7 2 2 ...
##  $ fresh_breath    : int  4 4 4 6 3 4 3 4 3 6 ...
##  $ prevent_decay   : int  6 3 7 6 2 6 4 7 2 1 ...
##  $ attract_teeth   : int  4 4 3 5 2 4 3 4 3 6 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(factor_analysis) <span class="co">#inspect data</span></code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prevent_cavities"],"name":[1],"type":["int"],"align":["right"]},{"label":["shiny_teeth"],"name":[2],"type":["int"],"align":["right"]},{"label":["strengthen_gum"],"name":[3],"type":["int"],"align":["right"]},{"label":["fresh_breath"],"name":[4],"type":["int"],"align":["right"]},{"label":["prevent_decay"],"name":[5],"type":["int"],"align":["right"]},{"label":["attract_teeth"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"7","2":"3","3":"6","4":"4","5":"6","6":"4"},{"1":"1","2":"3","3":"2","4":"4","5":"3","6":"4"},{"1":"6","2":"2","3":"7","4":"4","5":"7","6":"3"},{"1":"4","2":"5","3":"4","4":"6","5":"6","6":"5"},{"1":"1","2":"2","3":"2","4":"3","5":"2","6":"2"},{"1":"6","2":"3","3":"6","4":"4","5":"6","6":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><br></p>
<p>A <strong>construct</strong> is a specific type of concept that exists at a higher level of abstraction than everyday concepts. In this example, the <em>perceived benefits</em> of toothpaste represent the construct that we would like to measure. The construct is unobservable (‘latent’) but it can be inferred from other measurable variables (items) that together comprise a scale (latent construct). A <strong>multi-item scale</strong> consists of multiple items, where an item is a single question or statement to be evaluated. In the above example, we use six items to measure the perceived benefits of toothpaste. If several items correlate highly, they might measure aspects of a common underlying dimension (a.k.a. factors). That is, specific patterns in the correlation matrix signal the existence of one or more factors underlying the data. Let’s inspect the correlation matrix using the <code>rcorr()</code> function from the <code>Hmisc</code> package.</p>
<p><br></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;Hmisc&quot;</span>)
<span class="kw">rcorr</span>(<span class="kw">as.matrix</span>(factor_analysis))</code></pre>
<pre><code>##                  prevent_cavities shiny_teeth strengthen_gum fresh_breath
## prevent_cavities             1.00       -0.05           0.87        -0.09
## shiny_teeth                 -0.05        1.00          -0.16         0.57
## strengthen_gum               0.87       -0.16           1.00        -0.25
## fresh_breath                -0.09        0.57          -0.25         1.00
## prevent_decay                0.86       -0.02           0.78         0.01
## attract_teeth                0.00        0.64          -0.02         0.64
##                  prevent_decay attract_teeth
## prevent_cavities          0.86          0.00
## shiny_teeth              -0.02          0.64
## strengthen_gum            0.78         -0.02
## fresh_breath              0.01          0.64
## prevent_decay             1.00          0.14
## attract_teeth             0.14          1.00
## 
## n= 30 
## 
## 
## P
##                  prevent_cavities shiny_teeth strengthen_gum fresh_breath
## prevent_cavities                  0.7800      0.0000         0.6508      
## shiny_teeth      0.7800                       0.4134         0.0010      
## strengthen_gum   0.0000           0.4134                     0.1868      
## fresh_breath     0.6508           0.0010      0.1868                     
## prevent_decay    0.0000           0.9175      0.0000         0.9725      
## attract_teeth    0.9826           0.0001      0.9245         0.0001      
##                  prevent_decay attract_teeth
## prevent_cavities 0.0000        0.9826       
## shiny_teeth      0.9175        0.0001       
## strengthen_gum   0.0000        0.9245       
## fresh_breath     0.9725        0.0001       
## prevent_decay                  0.4723       
## attract_teeth    0.4723</code></pre>
<p><br></p>
<p>You can see that some of the items correlate highly, while others don’t. Specifically, there appear to be two groups of items that correlate highly and that might represent underlying dimensions of the construct:</p>
<ul>
<li>Factor 1: Items 1, 3, 5</li>
<li>Factor 2: Items 2, 4, 6</li>
</ul>
<p>Going back to the specific wording of the items you can see that the first group of items (i.e., items 1,3,5) refer to the <strong>health benefits</strong>, while the second item group (i.e., items 2,4,6) refer to the <strong>social benefits</strong>. Imagine now, for example, you would like to include the above variables as explanatory variables in a regression model. Due to the high degree of correlation among the items, you are likely to run into problems of multicollinearity. Instead of omitting some of the items, you might try to combine highly correlated items into one variable. Another application could be when you are developing a new measurement scale for a construct and you wish to explore the underlying dimensions of this construct. In these applications, you need to make sure that the questions that you are asking actually relate to the construct that you intend to measure.</p>
<p>The goal of factor analysis is to explain the maximum amount of total variance in a correlation matrix by transforming the original variables into linear components. This means that the correlation matrix is broken down into a smaller set of dimensions. The generalized formal representation of the linear relationship between a latent factor <em>Y</em> and the set of variables can be written as:</p>
<p><span class="math display" id="eq:factor1">\[\begin{equation} 
Y_i=b_1X_{1i} + b_2X_{2i} + b_nX_{ni}+\epsilon_i
\tag{7.1}
\end{equation}\]</span></p>
<p>where X<sub>n</sub> represents the data that we have collected for the different variables. To make it more explicit, the equation could also be written as</p>
<p><span class="math display" id="eq:factor2">\[\begin{equation} 
Factor_i=b_1Variable_{1i} + b_2Variable_{2i} + b_nVariable_{ni}+\epsilon_i
\tag{7.2}
\end{equation}\]</span></p>
<p>where the dependent variable “Factor” refers to the factor score of person <em>i</em> on the underlying dimensions. In our case, the initial inspection suggested two underlying factors (i.e., health benefits and social benefits), so that we can construct two equations that describe both factors in terms of the variables that we have measured:</p>
<p><span class="math display" id="eq:factor3">\[\begin{equation} 
Health_i=b_1X_{1i} + b_2X_{2i} + b_3X_{3i}+ b_4X_{4i}+ b_5X_{5i}+ b_6X_{6i}+\epsilon_i
\tag{7.3}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:factor4">\[\begin{equation} 
Social_i=b_1X_{1i} + b_2X_{2i} + b_3X_{3i}+ b_4X_{4i}+ b_5X_{5i}+ b_6X_{6i}+\epsilon_i
\tag{7.4}
\end{equation}\]</span></p>
<p>where the b’s in each equation represent the <strong>factor loadings</strong>. You can see that both equations include the same set of predictors. However, their values in each equation will be different, depending on the importance of each variable to the respective factor. Once the factor loadings have been computed (we will see how this is done below), we can summarize them in a component matrix, which is usually denoted as <code>A</code>:</p>
<p><span class="math display">\[\mathbf{A} = \left[\begin{array}
{rrr}
0.93 &amp; 0.25 \\
-0.30 &amp; 0.80 \\
0.94 &amp; 0.13 \\
-0.34 &amp; 0.79 \\
0.87 &amp; 0.35 \\
-0.18 &amp; 0.87
\end{array}\right]\]</span></p>
<p>The linear relation between the factors and the factor loadings can also be shown in a graph, where each axis represents a factor and the variables are placed on the coordinates according to the strength of the relationship between the variable and each factor. The greater the loading of variables on a factor, the more that factor explains relationships between those variables. You can also think of the factor loadings as the correlations between a factor and a variable.</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-373"></span>
<img src="_main_files/figure-html/unnamed-chunk-373-1.png" alt="Factor loadings" width="672" />
<p class="caption">
Figure 7.1: Factor loadings
</p>
</div>
<p><br></p>
<p>The factor loadings may then be used to compute the two new variables (i.e., factor scores) representing the two underlying dimensions. Using a rather simplistic approach, the factor scores for person <em>i</em> could be computed by</p>
<p><span class="math display" id="eq:factor5">\[\begin{equation} 
\begin{split}
Health_i=&amp; 0.93*preventCavities_{i} -0.3*shinyTeeth_{i} + 0.94*strengthenGum_{i}\\
          &amp;-0.34*freshBreath_{i} + 0.87*preventDecay_{i} - 0.18*attractTeeth_{i}
\end{split}
\tag{7.5}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:factor6">\[\begin{equation} 
\begin{split}
Social_i=&amp; 0.25*preventCavities_{i} + 0.80*shinyTeeth_{i} + 0.13*strengthenGum_{i}\\
         &amp;+ 0.79*freshBreath_{i}+ 0.35*preventDecay_{i}+ 0.87*attractTeeth_{i}
\end{split}
\tag{7.6}
\end{equation}\]</span></p>
<p>where the variable names are replaced by the values that were observed for respondent <em>i</em> to compute the factor scores for respondent <em>i</em>. This means that we have reduced the number of variables from six to two. Note that this is a rather simple approach that is intended to explain the underlying logic. However, that the resulting factor scores will depend on the measurement scales of the variables. If different measurement scales would be used, the resulting factor scores for different factors could not be compared. Thus, R will compute the factor scores using more sophisticated methods as we will see below.</p>
</div>
<div id="steps-in-factor-analysis" class="section level2">
<h2><span class="header-section-number">7.2</span> Steps in factor analysis</h2>
<p>Now that we have a broad understanding of how factor analysis works, let’s use another example to go through the process of deriving factors step by step. In this section, we will use spotify data.</p>
<div class="figure">
<img src="/home/felix/Documents/e-Assistant%20IMSM/course_daniel/Spotify_logo_with_text.svg.png" alt="Spotify Data (c)spotify.com" />
<p class="caption">Spotify Data (c)spotify.com</p>
</div>
<p>We have collected data for 4.276 songs and stored the results in the data set “spotify_data”.</p>
<pre class="sourceCode r"><code class="sourceCode r">spotify_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;/home/felix/Documents/e-Assistant IMSM/course_daniel/music_data.csv&quot;</span>, 
                          <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, 
                          <span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="co">#read in data</span>
<span class="co">#spotify_data &lt;- na.omit(spotify_data[16:27])</span>
spotify_data &lt;-<span class="st"> </span><span class="kw">na.omit</span>(spotify_data[,<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">16</span><span class="op">:</span><span class="dv">27</span>,<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">37</span>,<span class="dv">42</span>,<span class="dv">44</span>)])</code></pre>
<div id="are-the-assumptions-satisfied" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Are the assumptions satisfied?</h3>
<p>Since PCA is based on the correlation between variables, the first step is to inspect the correlation matrix, which can be created using the <code>cor()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">spotify_matrix &lt;-<span class="st"> </span><span class="kw">cor</span>(spotify_data)
<span class="kw">round</span>(spotify_matrix,<span class="dv">3</span>)</code></pre>
<pre><code>##                  trackPopularity danceability energy    key loudness
## trackPopularity            1.000        0.071 -0.016 -0.004    0.031
## danceability               0.071        1.000  0.016 -0.017    0.143
## energy                    -0.016        0.016  1.000  0.008    0.725
## key                       -0.004       -0.017  0.008  1.000   -0.008
## loudness                   0.031        0.143  0.725 -0.008    1.000
## mode                      -0.033       -0.072 -0.044 -0.172   -0.057
## speechiness                0.004        0.226 -0.023  0.013   -0.106
## acousticness               0.044       -0.271 -0.516  0.036   -0.481
## instrumentalness           0.018       -0.103 -0.059 -0.022   -0.131
## liveness                  -0.021       -0.105  0.128 -0.006    0.048
## valence                    0.021        0.174  0.348  0.065    0.199
## tempo                     -0.029        0.014  0.107 -0.019    0.079
## duration_ms               -0.032       -0.106  0.106  0.003    0.097
## followers                 -0.013        0.024 -0.023  0.013    0.011
## popularity                 0.155        0.147 -0.002 -0.011    0.091
## total_releases            -0.054        0.185 -0.041  0.019    0.001
## mstreams                  -0.007        0.093 -0.082 -0.006   -0.052
## adv_spending              -0.013        0.007 -0.016  0.009   -0.019
##                    mode speechiness acousticness instrumentalness liveness
## trackPopularity  -0.033       0.004        0.044            0.018   -0.021
## danceability     -0.072       0.226       -0.271           -0.103   -0.105
## energy           -0.044      -0.023       -0.516           -0.059    0.128
## key              -0.172       0.013        0.036           -0.022   -0.006
## loudness         -0.057      -0.106       -0.481           -0.131    0.048
## mode              1.000      -0.049        0.031           -0.014    0.006
## speechiness      -0.049       1.000       -0.056           -0.076    0.103
## acousticness      0.031      -0.056        1.000            0.100   -0.059
## instrumentalness -0.014      -0.076        0.100            1.000   -0.017
## liveness          0.006       0.103       -0.059           -0.017    1.000
## valence          -0.009      -0.002       -0.048           -0.077    0.020
## tempo             0.022       0.120       -0.136           -0.004    0.008
## duration_ms       0.013      -0.022       -0.070           -0.009    0.023
## followers        -0.032       0.002       -0.021           -0.004    0.011
## popularity       -0.097       0.106       -0.098           -0.011   -0.010
## total_releases   -0.019       0.220       -0.107           -0.035    0.058
## mstreams         -0.014       0.060        0.020            0.001    0.002
## adv_spending      0.008       0.002       -0.009            0.000    0.028
##                  valence  tempo duration_ms followers popularity
## trackPopularity    0.021 -0.029      -0.032    -0.013      0.155
## danceability       0.174  0.014      -0.106     0.024      0.147
## energy             0.348  0.107       0.106    -0.023     -0.002
## key                0.065 -0.019       0.003     0.013     -0.011
## loudness           0.199  0.079       0.097     0.011      0.091
## mode              -0.009  0.022       0.013    -0.032     -0.097
## speechiness       -0.002  0.120      -0.022     0.002      0.106
## acousticness      -0.048 -0.136      -0.070    -0.021     -0.098
## instrumentalness  -0.077 -0.004      -0.009    -0.004     -0.011
## liveness           0.020  0.008       0.023     0.011     -0.010
## valence            1.000 -0.008      -0.094    -0.038     -0.139
## tempo             -0.008  1.000      -0.008    -0.042      0.035
## duration_ms       -0.094 -0.008       1.000     0.118      0.073
## followers         -0.038 -0.042       0.118     1.000      0.560
## popularity        -0.139  0.035       0.073     0.560      1.000
## total_releases    -0.038  0.049       0.087     0.191      0.258
## mstreams          -0.020 -0.003      -0.040     0.228      0.219
## adv_spending      -0.011  0.025       0.001     0.064      0.026
##                  total_releases mstreams adv_spending
## trackPopularity          -0.054   -0.007       -0.013
## danceability              0.185    0.093        0.007
## energy                   -0.041   -0.082       -0.016
## key                       0.019   -0.006        0.009
## loudness                  0.001   -0.052       -0.019
## mode                     -0.019   -0.014        0.008
## speechiness               0.220    0.060        0.002
## acousticness             -0.107    0.020       -0.009
## instrumentalness         -0.035    0.001        0.000
## liveness                  0.058    0.002        0.028
## valence                  -0.038   -0.020       -0.011
## tempo                     0.049   -0.003        0.025
## duration_ms               0.087   -0.040        0.001
## followers                 0.191    0.228        0.064
## popularity                0.258    0.219        0.026
## total_releases            1.000    0.064        0.019
## mstreams                  0.064    1.000        0.265
## adv_spending              0.019    0.265        1.000</code></pre>
<p>If the variables measure the same construct, we would expect to see a certain degree of correlation between the variables. Even if the variables turn out to measure different dimensions of the same underlying construct, we would still expect to see some degree of correlation. So the first problem that could occur is that the <strong>correlations are not high enough</strong>. A first approach would be to scan the correlation matrix for correlations lower than about 0.3 and identify variables that have many correlations below this threshold. If your data set contains many variables, this task can be quite tedious. To make the task a little easier, you could proceed as follows.</p>
<p>Create a dataframe from the correlation matrix and set the diagonal elements to missing since these are always 1:</p>
<pre class="sourceCode r"><code class="sourceCode r">correlations &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(spotify_matrix)
<span class="kw">diag</span>(correlations) &lt;-<span class="st"> </span><span class="ot">NA</span></code></pre>
<p>Now we can use the <code>apply()</code> function to count the number of correlations for each variable that are below a certain threshold (say, 0.3). The <code>apply()</code> function is very useful as it lets you apply function by the rows or columns in your dataframe. In the following example <code>abs(correlations) &lt; 0.3</code> returns a logical value for the correlation matrix that returns <code>TRUE</code> if the statement is true. The second argument <code>1</code> means that the function should be applied to the rows (<code>2</code> would apply it to the columns). The third argument states the function that should be applied. In our case, we would like to count the number of absolute correlations below 0.3 so we apply the <code>sum</code> function, which sums the number of <code>TRUE</code> occurrences by row. The final argument <code>na.rm = TRUE</code> simply tells R to neglect the missing values that we have created for the diagonals of the matrix.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(<span class="kw">abs</span>(correlations) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span>, <span class="dv">1</span>, sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>##  trackPopularity     danceability           energy              key 
##               17               17               14               17 
##         loudness             mode      speechiness     acousticness 
##               15               17               17               15 
## instrumentalness         liveness          valence            tempo 
##               17               17               16               17 
##      duration_ms        followers       popularity   total_releases 
##               17               16               16               17 
##         mstreams     adv_spending 
##               17               17</code></pre>
<p>The output shows you the number of correlations below the threshold for each variable. In a similar way, it would also be possible to compute the mean correlation for each variable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(<span class="kw">abs</span>(correlations),<span class="dv">1</span>,mean,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>##  trackPopularity     danceability           energy              key 
##       0.03332842       0.10439080       0.13304498       0.02523003 
##         loudness             mode      speechiness     acousticness 
##       0.13405257       0.04073140       0.07008209       0.12374057 
## instrumentalness         liveness          valence            tempo 
##       0.04013710       0.03834385       0.07711655       0.04167564 
##      duration_ms        followers       popularity   total_releases 
##       0.05299221       0.08191999       0.11978083       0.08501118 
##         mstreams     adv_spending 
##       0.06926043       0.03061898</code></pre>
<p>Another way to make the correlations more salient is to plot the correlation matrix using different colors that indicate the strength of the correlations. This can be done using the <code>corPlot()</code> function from the <code>psych</code> package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">corPlot</span>(correlations,<span class="dt">numbers=</span><span class="ot">TRUE</span>,<span class="dt">upper=</span><span class="ot">FALSE</span>,<span class="dt">diag=</span><span class="ot">FALSE</span>,<span class="dt">xlas=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">&quot;Correlations between variables&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-379"></span>
<img src="_main_files/figure-html/unnamed-chunk-379-1.png" alt="Correlation matrix" width="960" />
<p class="caption">
Figure 7.2: Correlation matrix
</p>
</div>
<p>You will, however, notice that this is a rather subjective approach. The <strong>Bartlett’s test</strong> is a statistical test that can be used to test whether all the off-diagonal elements in the population correlation matrix are zero (i.e., whether the population correlation matrix resembles an identify matrix). Thus, it tests whether the correlations are overall too small. If the matrix is an identify matrix, it means that all variables are independent. Thus, a significant test statistic (i.e., p &lt; 0.05) indicates that there is some relationship between variables. The test can be implemented using the <code>cortest.bartlett()</code> function from the <code>psych</code> package:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(psych)
<span class="kw">cortest.bartlett</span>(spotify_matrix, <span class="dt">n =</span> <span class="kw">nrow</span>(spotify_data))</code></pre>
<pre><code>## $chisq
## [1] 11140.59
## 
## $p.value
## [1] 0
## 
## $df
## [1] 153</code></pre>
<p>In our example, the p-value is less than 0.05, which is good news since it confirms that overall the correlation between variables is different from zero.</p>
<p>The other problem that might occur is that <strong>the correlations are too high</strong>. Actually, a certain degree of multicollinearity is not a problem in PCA. However, it is important to avoid extreme multicollinearity (i.e., variables are highly correlated) and singularity (i.e., variables are perfectly correlated). Multicollinearity causes problems, because it becomes difficult to determine the unique contribution of a variable (as was the case in linear regression analysis). Again, inspecting the entire correlation matrix when there are many variables will be a tedious task. .</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(<span class="kw">abs</span>(correlations) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.8</span>, <span class="dv">1</span>, sum, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>##  trackPopularity     danceability           energy              key 
##                0                0                0                0 
##         loudness             mode      speechiness     acousticness 
##                0                0                0                0 
## instrumentalness         liveness          valence            tempo 
##                0                0                0                0 
##      duration_ms        followers       popularity   total_releases 
##                0                0                0                0 
##         mstreams     adv_spending 
##                0                0</code></pre>
<p>The results do not suggest any extreme or perfect correlations. Again, there is a more objective measure that could be applied. The <strong>determinant</strong> tells us whether the correlation matrix is singular (determinant = 0), or if all variables are completely unrelated (determinant = 1), or somewhere in between. As a rule of thumb, the determinant should be greater than 0.00001. The <code>det()</code> function can be used to compute the determinant:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">det</span>(spotify_matrix)</code></pre>
<pre><code>## [1] 0.07352295</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">det</span>(spotify_matrix) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.00001</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>As you can see, the determinant is larger than the threshold, indicating that the overall correlation between variables is not too strong.</p>
<p>Finally, you should test if the correlation pattern in the matrix is appropriate for factor analysis using the Kaiser-Meyer-Olkin (KMO) measure of sampling adequacy. This statistic is a measure of the proportion of variance among variables that might be common variance.</p>
<p><span class="math display" id="eq:MSA">\[\begin{equation} 
MSA_j=\frac{\sum_{k\ne j}^{}{r^2_{jk}}}{\sum_{k\ne j}^{}{r^2_{jk}}+\sum_{k\ne j}^{}{p^2_{jk}}}
\tag{7.7}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(r_{jk}\)</span> is the correlation between two variables of interest and <span class="math inline">\(p_{jk}\)</span> is their partial correlation. The partial correlation measures the degree of association between the two variables, when the effect of the remaining variables is controlled for. It can take values between 0 (bad) and 1 (good), where a value of 0 indicates that the sum of partial correlations is large relative to the sum of correlations. If the remaining correlation between two variables remains high if you control for all the other variables, this provides an indication that the correlation is fairly concentrated and on a subset of the variables and factor analysis is likely to be inappropriate. In contrast, a value close to 1 means that the sum of the partial correlations is fairly low, indicating a more compact pattern of correlations between a larger set of variables. Values should at least exceed 0.50, with the thresholds:</p>
<ul>
<li>&lt;.50 = unacceptable</li>
<li>&gt;.50 = miserable</li>
<li>&gt;.60 = mediocre</li>
<li>&gt;.70 = middling</li>
<li>&gt;.80 = meritorious</li>
<li>&gt;.90 = marvelous</li>
</ul>
<p>The KMO measure of sampling adequacy can be computed using the <code>KMO()</code> function from the <code>psych</code> package:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">KMO</span>(spotify_data)</code></pre>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = spotify_data)
## Overall MSA =  0.57
## MSA for each item = 
##  trackPopularity     danceability           energy              key 
##             0.34             0.45             0.56             0.49 
##         loudness             mode      speechiness     acousticness 
##             0.63             0.55             0.49             0.69 
## instrumentalness         liveness          valence            tempo 
##             0.58             0.51             0.43             0.62 
##      duration_ms        followers       popularity   total_releases 
##             0.62             0.55             0.56             0.69 
##         mstreams     adv_spending 
##             0.65             0.52</code></pre>
<p>You can see that the statistic is calculated for the entire matrix and for each variable individually. In our example, the values for all variables as well as the overall matrix is above 0.5, suggesting that factor analysis is appropriate.</p>
</div>
<div id="deriving-factors" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Deriving factors</h3>
<p>After testing that the data can be used for PCA, we can move on to conducting PCA. Conducting PCA is fairly simple in R using the <code>principal()</code> function from the <code>psych</code> package. However, before we apply the function to our data, it is useful to reflect on the goals of PCA again. The goal is to explain the maximum amount of total variance in a correlation matrix by transforming the original variables into a smaller set of linear components (factors). So the first decision we have to make is how many factors we should extract. There are different methods that can be used to decide on the appropriate number of factors, including:</p>
<ul>
<li><strong>A priori determination</strong>: Requires prior knowledge</li>
<li><strong>Determination based on percentage of variance</strong>: When cumulative percentage of variance extracted by the factors reaches a satisfactory level (e.g., factors extracted should account for at least 60% of the variance)</li>
<li><strong>Eigenvalues</strong>: Eigenvalues refer to the total variance that is explained by each factor. Factors with eigenvalues greater than 1.0 are retained (factors with a variance less than 1.0 are no better than a single variable)</li>
<li><strong>Scree plot</strong>: Is a plot of the eigenvalues against the number of factors in order of extraction. Assumption: the point at which the scree begins denotes the true number of factors.</li>
</ul>
<p>Often, the decision is made based on a combination of different criteria.</p>
<p>By extracting as many factors as there are variables we can inspect their eigenvalues and make decisions about which factors to extract. Since we have 18 variables, we set the argument <code>nfactors</code> to 18, which is equivalent to the number of columns <code>ncol</code> in our dataset.</p>
<pre class="sourceCode r"><code class="sourceCode r">pc1 &lt;-<span class="st"> </span><span class="kw">principal</span>(spotify_data, <span class="dt">nfactors =</span> <span class="kw">ncol</span>(spotify_data), <span class="dt">rotate =</span> <span class="st">&quot;none&quot;</span>)
pc1</code></pre>
<pre><code>## Principal Components Analysis
## Call: principal(r = spotify_data, nfactors = ncol(spotify_data), rotate = &quot;none&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                    PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9
## trackPopularity   0.01  0.09 -0.06  0.37 -0.21 -0.35  0.40  0.47 -0.43
## danceability      0.34  0.28 -0.60  0.14 -0.02 -0.26 -0.10 -0.12  0.09
## energy            0.83 -0.28  0.19  0.04  0.05  0.07  0.06  0.07  0.08
## key               0.01  0.01 -0.09  0.33 -0.29  0.63 -0.02 -0.18 -0.11
## loudness          0.83 -0.17  0.20  0.10  0.00 -0.07  0.02 -0.03 -0.04
## mode             -0.11 -0.13  0.11 -0.36  0.38 -0.43 -0.26  0.17  0.02
## speechiness       0.09  0.32 -0.56 -0.36 -0.06  0.17  0.10  0.17 -0.05
## acousticness     -0.75 -0.01  0.01  0.16 -0.03  0.09 -0.08  0.18  0.01
## instrumentalness -0.22 -0.02  0.22  0.04 -0.03 -0.02  0.56 -0.04  0.65
## liveness          0.13 -0.01  0.09 -0.32  0.12  0.45  0.08  0.70  0.05
## valence           0.37 -0.25 -0.27  0.36  0.14  0.08 -0.23  0.23  0.29
## tempo             0.20  0.02 -0.14 -0.37  0.14  0.02  0.55 -0.27 -0.15
## duration_ms       0.14  0.10  0.48 -0.30 -0.21  0.13 -0.17 -0.13 -0.26
## followers         0.11  0.69  0.38  0.13 -0.05 -0.03 -0.16  0.07  0.17
## popularity        0.20  0.76  0.22  0.10 -0.18 -0.16  0.09  0.08  0.00
## total_releases    0.16  0.52 -0.18 -0.34 -0.16  0.10 -0.16 -0.02  0.19
## mstreams         -0.02  0.49  0.02  0.25  0.55  0.09  0.02 -0.04  0.00
## adv_spending      0.00  0.22  0.06  0.16  0.69  0.24  0.10 -0.11 -0.23
##                   PC10  PC11  PC12  PC13  PC14  PC15  PC16  PC17  PC18 h2
## trackPopularity  -0.07  0.27  0.10 -0.06  0.08 -0.08 -0.12  0.09  0.01  1
## danceability     -0.23  0.06  0.04  0.08  0.12  0.43  0.20  0.08  0.10  1
## energy            0.03  0.04 -0.04  0.05 -0.09 -0.19  0.04  0.02  0.33  1
## key               0.22  0.22  0.45  0.23  0.00  0.05  0.02 -0.01  0.00  1
## loudness         -0.03 -0.06  0.06 -0.01  0.01 -0.15  0.34  0.14 -0.25  1
## mode              0.26  0.33  0.41  0.23 -0.07  0.01  0.05 -0.02  0.00  1
## speechiness      -0.07  0.11 -0.22  0.33 -0.37 -0.24  0.01  0.05 -0.05  1
## acousticness      0.21  0.15 -0.23 -0.12  0.02 -0.10  0.46  0.10  0.09  1
## instrumentalness -0.23  0.28  0.07  0.11 -0.04  0.03  0.03  0.01 -0.03  1
## liveness         -0.07 -0.21  0.09 -0.01  0.16  0.27  0.05 -0.01 -0.01  1
## valence           0.29  0.36 -0.30 -0.14  0.02  0.06 -0.14 -0.14 -0.10  1
## tempo             0.55  0.06 -0.12 -0.11  0.15  0.15  0.02  0.04  0.00  1
## duration_ms      -0.24  0.50 -0.32  0.13  0.14  0.17  0.01 -0.04 -0.01  1
## followers         0.28 -0.06 -0.07  0.01 -0.20  0.15 -0.15  0.35  0.00  1
## popularity        0.16 -0.11  0.02  0.00 -0.13  0.03  0.16 -0.41  0.01  1
## total_releases   -0.08  0.22  0.23 -0.46  0.23 -0.29 -0.03  0.04  0.02  1
## mstreams         -0.03 -0.05 -0.11  0.34  0.45 -0.24 -0.03  0.01  0.00  1
## adv_spending     -0.25  0.19  0.08 -0.31 -0.33  0.10  0.03 -0.02  0.00  1
##                                    u2  com
## trackPopularity  -0.00000000000000244  6.8
## danceability     -0.00000000000000067  5.1
## energy            0.00000000000000122  2.0
## key               0.00000000000000000  4.4
## loudness          0.00000000000000056  2.0
## mode             -0.00000000000000067  8.0
## speechiness      -0.00000000000000022  6.0
## acousticness      0.00000000000000044  2.8
## instrumentalness  0.00000000000000122  3.4
## liveness         -0.00000000000000111  3.3
## valence           0.00000000000000011 10.9
## tempo             0.00000000000000056  4.7
## duration_ms       0.00000000000000067  6.8
## followers         0.00000000000000011  3.7
## popularity        0.00000000000000011  2.7
## total_releases   -0.00000000000000178  6.7
## mstreams         -0.00000000000000067  4.8
## adv_spending      0.00000000000000233  3.9
## 
##                        PC1  PC2  PC3  PC4  PC5  PC6  PC7  PC8  PC9 PC10
## SS loadings           2.41 2.00 1.39 1.25 1.21 1.15 1.04 1.02 0.94 0.90
## Proportion Var        0.13 0.11 0.08 0.07 0.07 0.06 0.06 0.06 0.05 0.05
## Cumulative Var        0.13 0.25 0.32 0.39 0.46 0.52 0.58 0.64 0.69 0.74
## Proportion Explained  0.13 0.11 0.08 0.07 0.07 0.06 0.06 0.06 0.05 0.05
## Cumulative Proportion 0.13 0.25 0.32 0.39 0.46 0.52 0.58 0.64 0.69 0.74
##                       PC11 PC12 PC13 PC14 PC15 PC16 PC17 PC18
## SS loadings           0.88 0.78 0.72 0.65 0.63 0.46 0.36 0.21
## Proportion Var        0.05 0.04 0.04 0.04 0.03 0.03 0.02 0.01
## Cumulative Var        0.79 0.83 0.87 0.91 0.94 0.97 0.99 1.00
## Proportion Explained  0.05 0.04 0.04 0.04 0.03 0.03 0.02 0.01
## Cumulative Proportion 0.79 0.83 0.87 0.91 0.94 0.97 0.99 1.00
## 
## Mean item complexity =  4.9
## Test of the hypothesis that 18 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0 
##  with the empirical chi square  0  with prob &lt;  NA 
## 
## Fit based upon off diagonal values = 1</code></pre>
<p>The output is quite complex, but we will focus only on the <code>SS loadings</code> for now, which are the Eigenvalues (a.k.a. sum of squared loadings). One common rule is to retain factors with eigenvalues greater than 1.0. So based on this rule, we would extract eight factors (i.e., the SS loadings for the nineth factor is &lt; 1).</p>
<p>You can also plot the eigenvalues against the number of factors in order of extraction using a so-called <strong>Scree plot</strong>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(pc1<span class="op">$</span>values, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>)
<span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(spotify_data)))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">8</span>, <span class="dt">lty=</span><span class="dv">2</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-385"></span>
<img src="_main_files/figure-html/unnamed-chunk-385-1.png" alt="Scree plot" width="672" />
<p class="caption">
Figure 7.3: Scree plot
</p>
</div>
<p>The dashed line is simply a visualization of the rule that we will retain factors with Eigenvalues &gt; 1 (suggesting eight factors). Another criterion based on this plot would be to find the point where the curve flattens (point of inflection). If the largest few eigenvalues in the covariance matrix dominate in magnitude, then the scree plot will exhibit an “elbow”. From that point onwards, the incremental gain in explained variance is rather low. Also according to this criterion, we would extract eight factors. Taken together, the results suggest that we should extract eight factors.</p>
<p>Now that we know how many components we want to extract, we can rerun the analysis, specifying that number:</p>
<pre class="sourceCode r"><code class="sourceCode r">pc2 &lt;-<span class="st"> </span><span class="kw">principal</span>(spotify_data, <span class="dt">nfactors =</span> <span class="dv">8</span>, <span class="dt">rotate =</span> <span class="st">&quot;none&quot;</span>)
pc2</code></pre>
<pre><code>## Principal Components Analysis
## Call: principal(r = spotify_data, nfactors = 8, rotate = &quot;none&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                    PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   h2   u2
## trackPopularity   0.01  0.09 -0.06  0.37 -0.21 -0.35  0.40  0.47 0.69 0.31
## danceability      0.34  0.28 -0.60  0.14 -0.02 -0.26 -0.10 -0.12 0.67 0.33
## energy            0.83 -0.28  0.19  0.04  0.05  0.07  0.06  0.07 0.83 0.17
## key               0.01  0.01 -0.09  0.33 -0.29  0.63 -0.02 -0.18 0.63 0.37
## loudness          0.83 -0.17  0.20  0.10  0.00 -0.07  0.02 -0.03 0.77 0.23
## mode             -0.11 -0.13  0.11 -0.36  0.38 -0.43 -0.26  0.17 0.60 0.40
## speechiness       0.09  0.32 -0.56 -0.36 -0.06  0.17  0.10  0.17 0.63 0.37
## acousticness     -0.75 -0.01  0.01  0.16 -0.03  0.09 -0.08  0.18 0.63 0.37
## instrumentalness -0.22 -0.02  0.22  0.04 -0.03 -0.02  0.56 -0.04 0.42 0.58
## liveness          0.13 -0.01  0.09 -0.32  0.12  0.45  0.08  0.70 0.84 0.16
## valence           0.37 -0.25 -0.27  0.36  0.14  0.08 -0.23  0.23 0.53 0.47
## tempo             0.20  0.02 -0.14 -0.37  0.14  0.02  0.55 -0.27 0.59 0.41
## duration_ms       0.14  0.10  0.48 -0.30 -0.21  0.13 -0.17 -0.13 0.46 0.54
## followers         0.11  0.69  0.38  0.13 -0.05 -0.03 -0.16  0.07 0.68 0.32
## popularity        0.20  0.76  0.22  0.10 -0.18 -0.16  0.09  0.08 0.75 0.25
## total_releases    0.16  0.52 -0.18 -0.34 -0.16  0.10 -0.16 -0.02 0.50 0.50
## mstreams         -0.02  0.49  0.02  0.25  0.55  0.09  0.02 -0.04 0.62 0.38
## adv_spending      0.00  0.22  0.06  0.16  0.69  0.24  0.10 -0.11 0.63 0.37
##                  com
## trackPopularity  4.4
## danceability     2.9
## energy           1.4
## key              2.2
## loudness         1.3
## mode             4.6
## speechiness      3.0
## acousticness     1.3
## instrumentalness 1.7
## liveness         2.4
## valence          5.6
## tempo            3.0
## duration_ms      3.1
## followers        1.9
## popularity       1.6
## total_releases   2.9
## mstreams         2.5
## adv_spending     1.7
## 
##                        PC1  PC2  PC3  PC4  PC5  PC6  PC7  PC8
## SS loadings           2.41 2.00 1.39 1.25 1.21 1.15 1.04 1.02
## Proportion Var        0.13 0.11 0.08 0.07 0.07 0.06 0.06 0.06
## Cumulative Var        0.13 0.25 0.32 0.39 0.46 0.52 0.58 0.64
## Proportion Explained  0.21 0.17 0.12 0.11 0.11 0.10 0.09 0.09
## Cumulative Proportion 0.21 0.38 0.51 0.62 0.72 0.82 0.91 1.00
## 
## Mean item complexity =  2.6
## Test of the hypothesis that 8 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.09 
##  with the empirical chi square  9473.51  with prob &lt;  0 
## 
## Fit based upon off diagonal values = 0.56</code></pre>
<p>Now that the output is less complex, we can inspect the remaining statistics. The first part of the output is the <strong>factor matrix</strong>, which contains the factor loadings of all the variables on the eight extracted factors (i.e., PC1, PC2, PC3, PC4, PC5, PC6, PC7, PC8). As we have said before, the <strong>factor loadings</strong> are the correlations between the variables and the factors. The factor matrix also contains the columns “h2” and “u2”. “h2” refers to the <strong>communality</strong>, which is the proportion of variance a variable shares with all the other variables being considered. This is also the proportion of variance explained by the common factors. In contrast, “u2” refers to the unique variance, which is the proportion of the variance that is unique to a particular variable. In PCA, we are primarily interested in the common variance. When the communality is very low (say &lt;.30), a variable is “quite unique” and should be removed, as it is definitely measuring “something else”. In our example, all communalities (i.e., h2) are above 0.3 so that we retain all variables.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#pc2$communality &lt; 0.3</span>
<span class="kw">sum</span>(pc2<span class="op">$</span>communality <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span>)</code></pre>
<pre><code>## [1] 0</code></pre>
<p>Note that there is a difference between PCA and common factor analysis. PCA focuses on the variance and aims to reproduce the total variable variance. This means that the components reflect both common and unique variance of the variables. Factor analysis, in contrast, focuses on the correlation and aims to reproduce the correlations among variables. Here, the factors only represent the common variance that variable share and do not include the unique variance. In other words, while factor analysis focuses on explaining the off-diagonal terms in the correlation matrix (i.e., shared co-variance), PCA focuses on explaining the diagonal terms (i.e., the variances). However, although PCA aims to reproduce the on-diagonal terms in the correlation matrix, it also tends to fit the off-diagonal correlations quite well. Hence, the results are often comparable. See also <a href="https://en.wikipedia.org/wiki/Principal_component_analysis#Relation_between_PCA_and_factor_analysis" target="_blank">here</a>.</p>
<p>You should also take a closer look at the residuals in order to check whether you have extracted the correct number of factors. The difference between the reproduced and the actual correlation matrices are the residuals. We can extract the residuals from our model using the <code>factor.residuals()</code> function from the <code>psych</code> package. It takes the original correlation matrix and the factor loadings as arguments:</p>
<pre class="sourceCode r"><code class="sourceCode r">residuals &lt;-<span class="st"> </span><span class="kw">factor.residuals</span>(spotify_matrix, pc2<span class="op">$</span>loadings)
<span class="kw">round</span>(residuals,<span class="dv">3</span>)</code></pre>
<pre><code>##                  trackPopularity danceability energy    key loudness
## trackPopularity            0.312       -0.045 -0.026  0.117   -0.009
## danceability              -0.045        0.331 -0.049  0.015   -0.005
## energy                    -0.026       -0.049  0.172 -0.010   -0.049
## key                        0.117        0.015 -0.010  0.367    0.011
## loudness                  -0.009       -0.005 -0.049  0.011    0.230
## mode                       0.075        0.005  0.023  0.365    0.009
## speechiness                0.004       -0.111  0.086 -0.020    0.038
## acousticness              -0.028        0.008  0.085 -0.046    0.131
## instrumentalness          -0.198        0.152  0.046 -0.005   -0.015
## liveness                  -0.080        0.158 -0.079 -0.016    0.000
## valence                   -0.069       -0.064 -0.005 -0.055   -0.112
## tempo                      0.044       -0.062 -0.036  0.079   -0.034
## duration_ms                0.218        0.148 -0.039 -0.023   -0.057
## followers                 -0.092       -0.014  0.012  0.003   -0.044
## popularity                -0.109       -0.048  0.007  0.030   -0.008
## total_releases             0.083       -0.075  0.030 -0.006    0.037
## mstreams                   0.015       -0.030  0.021  0.000    0.023
## adv_spending               0.154        0.036 -0.023 -0.017    0.006
##                    mode speechiness acousticness instrumentalness liveness
## trackPopularity   0.075       0.004       -0.028           -0.198   -0.080
## danceability      0.005      -0.111        0.008            0.152    0.158
## energy            0.023       0.086        0.085            0.046   -0.079
## key               0.365      -0.020       -0.046           -0.005   -0.016
## loudness          0.009       0.038        0.131           -0.015    0.000
## mode              0.405       0.028        0.004            0.106   -0.058
## speechiness       0.028       0.371        0.034            0.044   -0.166
## acousticness      0.004       0.034        0.372           -0.022   -0.066
## instrumentalness  0.106       0.044       -0.022            0.577    0.001
## liveness         -0.058      -0.166       -0.066            0.001    0.162
## valence           0.042       0.001        0.109            0.190   -0.090
## tempo             0.074      -0.123        0.165           -0.229   -0.004
## duration_ms      -0.010       0.105        0.063            0.016   -0.060
## followers         0.029       0.036        0.014            0.035   -0.005
## popularity        0.041      -0.004        0.038           -0.055    0.011
## total_releases    0.024      -0.194        0.046            0.154   -0.050
## mstreams         -0.021       0.022       -0.013           -0.003    0.004
## adv_spending     -0.022       0.026       -0.008           -0.056   -0.047
##                  valence  tempo duration_ms followers popularity
## trackPopularity   -0.069  0.044       0.218    -0.092     -0.109
## danceability      -0.064 -0.062       0.148    -0.014     -0.048
## energy            -0.005 -0.036      -0.039     0.012      0.007
## key               -0.055  0.079      -0.023     0.003      0.030
## loudness          -0.112 -0.034      -0.057    -0.044     -0.008
## mode               0.042  0.074      -0.010     0.029      0.041
## speechiness        0.001 -0.123       0.105     0.036     -0.004
## acousticness       0.109  0.165       0.063     0.014      0.038
## instrumentalness   0.190 -0.229       0.016     0.035     -0.055
## liveness          -0.090 -0.004      -0.060    -0.005      0.011
## valence            0.466  0.195       0.126     0.107      0.038
## tempo              0.195  0.405       0.005     0.136      0.051
## duration_ms        0.126  0.005       0.544    -0.135     -0.097
## followers          0.107  0.136      -0.135     0.324     -0.087
## popularity         0.038  0.051      -0.097    -0.087      0.248
## total_releases     0.088 -0.046      -0.073    -0.097     -0.091
## mstreams          -0.044 -0.012       0.082    -0.113     -0.070
## adv_spending      -0.059 -0.100       0.118    -0.059     -0.004
##                  total_releases mstreams adv_spending
## trackPopularity           0.083    0.015        0.154
## danceability             -0.075   -0.030        0.036
## energy                    0.030    0.021       -0.023
## key                      -0.006    0.000       -0.017
## loudness                  0.037    0.023        0.006
## mode                      0.024   -0.021       -0.022
## speechiness              -0.194    0.022        0.026
## acousticness              0.046   -0.013       -0.008
## instrumentalness          0.154   -0.003       -0.056
## liveness                 -0.050    0.004       -0.047
## valence                   0.088   -0.044       -0.059
## tempo                    -0.046   -0.012       -0.100
## duration_ms              -0.073    0.082        0.118
## followers                -0.097   -0.113       -0.059
## popularity               -0.091   -0.070       -0.004
## total_releases            0.496   -0.016        0.075
## mstreams                 -0.016    0.383       -0.286
## adv_spending              0.075   -0.286        0.372</code></pre>
<p>Note that the diagonal elements in the residual matrix correspond to the unique variance in each variable that cannot be explained by the factors (i.e., “u2” in the output above). For example, the proportion of unique variance for <code>trackPopularity</code> is 0.31, which is reflected in the first cell in the residual matrix. The off-diagonal elements represent the difference between the actual correlations and the correlation based on the reproduced correlation matrix for all variable pairs. To see this, the reproduced correlation matrix could be generated by using the <code>factor.model()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r">reproduced_matrix &lt;-<span class="st"> </span><span class="kw">factor.model</span>(pc2<span class="op">$</span>loadings)
<span class="kw">round</span>(reproduced_matrix,<span class="dv">3</span>)</code></pre>
<pre><code>##                  trackPopularity danceability energy    key loudness
## trackPopularity            0.688        0.115  0.010 -0.120    0.040
## danceability               0.115        0.669  0.066 -0.033    0.149
## energy                     0.010        0.066  0.828  0.018    0.774
## key                       -0.120       -0.033  0.018  0.633   -0.018
## loudness                   0.040        0.149  0.774 -0.018    0.770
## mode                      -0.108       -0.077 -0.067 -0.537   -0.066
## speechiness                0.000        0.337 -0.109  0.033   -0.144
## acousticness               0.072       -0.280 -0.601  0.083   -0.612
## instrumentalness           0.216       -0.255 -0.105 -0.017   -0.116
## liveness                   0.059       -0.262  0.208  0.010    0.048
## valence                    0.090        0.238  0.353  0.120    0.311
## tempo                     -0.073        0.076  0.142 -0.099    0.113
## duration_ms               -0.250       -0.254  0.145  0.026    0.154
## followers                  0.079        0.038 -0.035  0.010    0.055
## popularity                 0.263        0.195 -0.010 -0.041    0.099
## total_releases            -0.137        0.260 -0.072  0.025   -0.036
## mstreams                  -0.023        0.123 -0.103 -0.006   -0.075
## adv_spending              -0.168       -0.029  0.007  0.025   -0.025
##                    mode speechiness acousticness instrumentalness liveness
## trackPopularity  -0.108       0.000        0.072            0.216    0.059
## danceability     -0.077       0.337       -0.280           -0.255   -0.262
## energy           -0.067      -0.109       -0.601           -0.105    0.208
## key              -0.537       0.033        0.083           -0.017    0.010
## loudness         -0.066      -0.144       -0.612           -0.116    0.048
## mode              0.595      -0.078        0.026           -0.121    0.063
## speechiness      -0.078       0.629       -0.091           -0.120    0.269
## acousticness      0.026      -0.091        0.628            0.122    0.007
## instrumentalness -0.121      -0.120        0.122            0.423   -0.018
## liveness          0.063       0.269        0.007           -0.018    0.838
## valence          -0.051      -0.003       -0.157           -0.267    0.110
## tempo            -0.052       0.243       -0.301            0.225    0.012
## duration_ms       0.023      -0.128       -0.132           -0.025    0.083
## followers        -0.061      -0.034       -0.035           -0.039    0.016
## popularity       -0.138       0.110       -0.136            0.045   -0.022
## total_releases   -0.043       0.414       -0.154           -0.189    0.108
## mstreams          0.008       0.038        0.032            0.004   -0.002
## adv_spending      0.031      -0.024        0.000            0.056    0.074
##                  valence  tempo duration_ms followers popularity
## trackPopularity    0.090 -0.073      -0.250     0.079      0.263
## danceability       0.238  0.076      -0.254     0.038      0.195
## energy             0.353  0.142       0.145    -0.035     -0.010
## key                0.120 -0.099       0.026     0.010     -0.041
## loudness           0.311  0.113       0.154     0.055      0.099
## mode              -0.051 -0.052       0.023    -0.061     -0.138
## speechiness       -0.003  0.243      -0.128    -0.034      0.110
## acousticness      -0.157 -0.301      -0.132    -0.035     -0.136
## instrumentalness  -0.267  0.225      -0.025    -0.039      0.045
## liveness           0.110  0.012       0.083     0.016     -0.022
## valence            0.534 -0.203      -0.221    -0.144     -0.177
## tempo             -0.203  0.595      -0.013    -0.177     -0.016
## duration_ms       -0.221 -0.013       0.456     0.252      0.170
## followers         -0.144 -0.177       0.252     0.676      0.647
## popularity        -0.177 -0.016       0.170     0.647      0.752
## total_releases    -0.126  0.095       0.160     0.288      0.349
## mstreams           0.024  0.009      -0.122     0.341      0.289
## adv_spending       0.048  0.125      -0.117     0.123      0.030
##                  total_releases mstreams adv_spending
## trackPopularity          -0.137   -0.023       -0.168
## danceability              0.260    0.123       -0.029
## energy                   -0.072   -0.103        0.007
## key                       0.025   -0.006        0.025
## loudness                 -0.036   -0.075       -0.025
## mode                     -0.043    0.008        0.031
## speechiness               0.414    0.038       -0.024
## acousticness             -0.154    0.032        0.000
## instrumentalness         -0.189    0.004        0.056
## liveness                  0.108   -0.002        0.074
## valence                  -0.126    0.024        0.048
## tempo                     0.095    0.009        0.125
## duration_ms               0.160   -0.122       -0.117
## followers                 0.288    0.341        0.123
## popularity                0.349    0.289        0.030
## total_releases            0.504    0.080       -0.056
## mstreams                  0.080    0.617        0.551
## adv_spending             -0.056    0.551        0.628</code></pre>
<p>You can see that the reproduced correlation between the first and second variable is 0.115. From the correlation table from the beginning we know, however, that the observed correlation was 0.071. Hence, the difference between the observed and reproduced correlation is: 0.071 - 0.115 = -0.045, which corresponds to the residual of this variable pair in the residual matrix. Note that the diagonal elements in the reproduced matrix correspond to the communalities in the model summary above (i.e., “h2”).</p>
<p>A measure of fit can now be computed based on the size of the residuals. In the worst case, the residuals would be as large as the correlations in the original matrix, which would be the case if we extracted no factors at all. A measure of fit could therefore be the sum of the squared residuals divided by the sum of the squared correlations. We square the residuals to account for positive and negative deviations. <strong>Values &gt;0.90 are considered indicators of good fit.</strong> From the output above, you can see that: “Fit based upon off diagonal values = 0.56”. Thus, we conclude that the model does not have a good fit.</p>
<p>You could also manually compute this statistic by summing over the squared residuals and correlations, take their ratio and subtract it from one (note that we use the <code>upper.tri()</code> function to use the upper triangle of the matrix only; this has the effect of discarding the diagonal elements and the elements below the diagonal).</p>
<pre class="sourceCode r"><code class="sourceCode r">ssr &lt;-<span class="st"> </span>(<span class="kw">sum</span>(residuals[<span class="kw">upper.tri</span>((residuals))]<span class="op">^</span><span class="dv">2</span>)) <span class="co">#sum of squared residuals </span>
ssc &lt;-<span class="st"> </span>(<span class="kw">sum</span>(spotify_matrix[<span class="kw">upper.tri</span>((spotify_matrix))]<span class="op">^</span><span class="dv">2</span>)) <span class="co">#sum of squared correlations</span>
<span class="dv">1</span><span class="op">-</span>(ssr<span class="op">/</span>ssc) <span class="co">#model fit</span></code></pre>
<pre><code>## [1] 0.5577161</code></pre>
<p>In a next step, we check the size of the residuals. <strong>If fewer residuals than 50% have absolute values greater than 0.05 the model is a good fit.</strong> This can be tested using the following code. We first convert the residuals to a matrix and select the upper triangular again to avoid duplicates. Finally, we count all occurrences where the absolute value is larger than 0.05 and divide it by the number of total observations to get the proportion.</p>
<pre class="sourceCode r"><code class="sourceCode r">residuals &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(residuals[<span class="kw">upper.tri</span>((residuals))])
large_res &lt;-<span class="st"> </span><span class="kw">abs</span>(residuals) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span>
<span class="kw">sum</span>(large_res)</code></pre>
<pre><code>## [1] 65</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(large_res)<span class="op">/</span><span class="kw">nrow</span>(residuals)</code></pre>
<pre><code>## [1] 0.4248366</code></pre>
<p>In our example, we can confirm that the proportion of residuals &gt; 0.05 is less than 50%.</p>
<p>Another way to evaluate the residuals is by looking at their mean value (rather, we square the residuals first to account for positive and negative values, compute the mean and then take the square root).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>(<span class="kw">mean</span>(residuals<span class="op">^</span><span class="dv">2</span>))</code></pre>
<pre><code>## [1] 0.08508949</code></pre>
<p>This means that our mean residual is 0.085 and this value should be as low as possible.</p>
<p>Finally, we need to validate if the residuals are approximately normally distributed, which we do by using a histogram, a Q-Q plot and the Shapiro test.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(residuals)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-393"></span>
<img src="_main_files/figure-html/unnamed-chunk-393-1.png" alt="Histogram of residuals" width="672" />
<p class="caption">
Figure 7.4: Histogram of residuals
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(residuals) 
<span class="kw">qqline</span>(residuals)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-394"></span>
<img src="_main_files/figure-html/unnamed-chunk-394-1.png" alt="Q-Q plot" width="672" />
<p class="caption">
Figure 7.5: Q-Q plot
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shapiro.test</span>(residuals)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals
## W = 0.96101, p-value = 0.0002596</code></pre>
<p>All of the tests suggest that the distribution of the residuals is approximately normal.</p>
</div>
<div id="factor-interpretation" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Factor interpretation</h3>
<p>To aid interpretation, it is possible to maximize the loading of a variable on one factor while minimizing its loading on all other factors. This is known as factor rotation. There are two types of factor rotation:</p>
<ul>
<li>orthogonal (assumes that factors are uncorrelated)</li>
<li>oblique (assumes that factors are intercorrelated)</li>
</ul>
<p>To carry out a orthogonal rotation, we change the rotate option in the <code>principal()</code> function from “none” to “varimax” (we could also exclude it altogether because varimax is the default if the option is not specified):</p>
<pre class="sourceCode r"><code class="sourceCode r">pc3 &lt;-<span class="st"> </span><span class="kw">principal</span>(spotify_data, <span class="dt">nfactors =</span> <span class="dv">8</span>, <span class="dt">rotate =</span> <span class="st">&quot;varimax&quot;</span>)
pc3</code></pre>
<pre><code>## Principal Components Analysis
## Call: principal(r = spotify_data, nfactors = 8, rotate = &quot;varimax&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                    RC1   RC2   RC3   RC5   RC6   RC4   RC8   RC7   h2   u2
## trackPopularity   0.01  0.17 -0.06 -0.14 -0.01  0.79  0.06  0.06 0.69 0.31
## danceability      0.20  0.03  0.57  0.08  0.00  0.24 -0.42 -0.23 0.67 0.33
## energy            0.88 -0.05 -0.10 -0.02  0.05  0.00  0.17 -0.07 0.83 0.17
## key              -0.04 -0.04 -0.01  0.02  0.77 -0.12  0.04 -0.12 0.63 0.37
## loudness          0.86  0.07 -0.09 -0.04  0.02  0.02 -0.01 -0.08 0.77 0.23
## mode             -0.06 -0.08 -0.06  0.03 -0.74 -0.12  0.06 -0.11 0.60 0.40
## speechiness      -0.07 -0.03  0.76  0.01  0.05  0.05  0.19  0.06 0.63 0.37
## acousticness     -0.74 -0.06 -0.22  0.01  0.06  0.09  0.10 -0.09 0.63 0.37
## instrumentalness -0.12  0.01 -0.25  0.03  0.08  0.21  0.05  0.54 0.42 0.58
## liveness          0.08 -0.01  0.14  0.04 -0.03  0.03  0.90 -0.04 0.84 0.16
## valence           0.34 -0.26  0.03  0.12  0.11  0.23  0.05 -0.52 0.53 0.47
## tempo             0.24 -0.17  0.30  0.11 -0.04 -0.06 -0.03  0.63 0.59 0.41
## duration_ms       0.14  0.35 -0.15 -0.22  0.00 -0.46  0.14  0.09 0.46 0.54
## followers        -0.01  0.80 -0.01  0.18  0.02 -0.04  0.01 -0.09 0.68 0.32
## popularity        0.07  0.81  0.18  0.08  0.03  0.18 -0.06  0.09 0.75 0.25
## total_releases   -0.01  0.37  0.56 -0.05  0.02 -0.22  0.04 -0.02 0.50 0.50
## mstreams         -0.07  0.26  0.06  0.73 -0.01  0.05 -0.04 -0.04 0.62 0.38
## adv_spending      0.02 -0.02 -0.05  0.78  0.00 -0.09  0.06  0.07 0.63 0.37
##                  com
## trackPopularity  1.2
## danceability     3.0
## energy           1.1
## key              1.1
## loudness         1.1
## mode             1.2
## speechiness      1.2
## acousticness     1.3
## instrumentalness 1.9
## liveness         1.1
## valence          3.0
## tempo            2.1
## duration_ms      3.2
## followers        1.1
## popularity       1.3
## total_releases   2.1
## mstreams         1.3
## adv_spending     1.1
## 
##                        RC1  RC2  RC3  RC5  RC6  RC4  RC8  RC7
## SS loadings           2.35 1.77 1.53 1.29 1.18 1.14 1.10 1.10
## Proportion Var        0.13 0.10 0.08 0.07 0.07 0.06 0.06 0.06
## Cumulative Var        0.13 0.23 0.31 0.39 0.45 0.51 0.58 0.64
## Proportion Explained  0.20 0.15 0.13 0.11 0.10 0.10 0.10 0.10
## Cumulative Proportion 0.20 0.36 0.49 0.61 0.71 0.81 0.90 1.00
## 
## Mean item complexity =  1.6
## Test of the hypothesis that 8 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.09 
##  with the empirical chi square  9473.51  with prob &lt;  0 
## 
## Fit based upon off diagonal values = 0.56</code></pre>
<p>Interpreting the factor loading matrix is a little complex, so we can make it easier by using the <code>print.psych()</code> function, which we can use to exclude loading below a cutoff from the display and order the variables by their loading within each factor. In the following, we will only display loadings that exceed the value 0.3.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print.psych</span>(pc3, <span class="dt">cut =</span> <span class="fl">0.3</span>, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>## Principal Components Analysis
## Call: principal(r = spotify_data, nfactors = 8, rotate = &quot;varimax&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                  item   RC1   RC2   RC3   RC5   RC6   RC4   RC8   RC7   h2
## energy              3  0.88                                           0.83
## loudness            5  0.86                                           0.77
## acousticness        8 -0.74                                           0.63
## popularity         15        0.81                                     0.75
## followers          14        0.80                                     0.68
## speechiness         7              0.76                               0.63
## danceability        2              0.57                   -0.42       0.67
## total_releases     16        0.37  0.56                               0.50
## adv_spending       18                    0.78                         0.63
## mstreams           17                    0.73                         0.62
## key                 4                          0.77                   0.63
## mode                6                         -0.74                   0.60
## trackPopularity     1                                0.79             0.69
## duration_ms        13        0.35                   -0.46             0.46
## liveness           10                                      0.90       0.84
## tempo              12                                            0.63 0.59
## instrumentalness    9                                            0.54 0.42
## valence            11  0.34                                     -0.52 0.53
##                    u2 com
## energy           0.17 1.1
## loudness         0.23 1.1
## acousticness     0.37 1.3
## popularity       0.25 1.3
## followers        0.32 1.1
## speechiness      0.37 1.2
## danceability     0.33 3.0
## total_releases   0.50 2.1
## adv_spending     0.37 1.1
## mstreams         0.38 1.3
## key              0.37 1.1
## mode             0.40 1.2
## trackPopularity  0.31 1.2
## duration_ms      0.54 3.2
## liveness         0.16 1.1
## tempo            0.41 2.1
## instrumentalness 0.58 1.9
## valence          0.47 3.0
## 
##                        RC1  RC2  RC3  RC5  RC6  RC4  RC8  RC7
## SS loadings           2.35 1.77 1.53 1.29 1.18 1.14 1.10 1.10
## Proportion Var        0.13 0.10 0.08 0.07 0.07 0.06 0.06 0.06
## Cumulative Var        0.13 0.23 0.31 0.39 0.45 0.51 0.58 0.64
## Proportion Explained  0.20 0.15 0.13 0.11 0.10 0.10 0.10 0.10
## Cumulative Proportion 0.20 0.36 0.49 0.61 0.71 0.81 0.90 1.00
## 
## Mean item complexity =  1.6
## Test of the hypothesis that 8 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.09 
##  with the empirical chi square  9473.51  with prob &lt;  0 
## 
## Fit based upon off diagonal values = 0.56</code></pre>
<p>After obtaining the rotated matrix, variables with high loading are used for interpreting (=naming) the factor. Note that factor loading can be positive or negative (depends on scaling of the variable), thus take care when interpreting! Look for simple structure: each variable (hopefully) loads high on 1 factor and low on other factors.</p>
<p>As an example, we could name our factors as follows:</p>
<ul>
<li><strong>Factor 1:</strong> loud</li>
<li><strong>Factor 2:</strong> trending</li>
<li><strong>Factor 3:</strong> dancefloor</li>
<li><strong>Factor 4:</strong> shortness</li>
<li><strong>Factor 5:</strong> affluent</li>
<li><strong>Factor 6:</strong> key</li>
<li><strong>Factor 7:</strong> fast_instrumental</li>
<li><strong>Factor 8:</strong> livemusic</li>
</ul>
<p>The previous type of rotation (i.e., “varimax”) assumed that the factors are independent. Oblique rotation is another type of rotation that can handle correlation between the factors. The command for an oblique rotation is very similar to that for an orthogonal rotation – we just change the rotate option from “varimax” to “oblimin”.</p>
<pre class="sourceCode r"><code class="sourceCode r">pc4 &lt;-<span class="st"> </span><span class="kw">principal</span>(spotify_data, <span class="dt">nfactors =</span> <span class="dv">8</span>, <span class="dt">rotate =</span> <span class="st">&quot;oblimin&quot;</span>, <span class="dt">scores =</span> <span class="ot">TRUE</span>)
<span class="kw">print.psych</span>(pc4, <span class="dt">cut =</span> <span class="fl">0.3</span>, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>## Principal Components Analysis
## Call: principal(r = spotify_data, nfactors = 8, rotate = &quot;oblimin&quot;, 
##     scores = TRUE)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                  item   TC1   TC2   TC3   TC5   TC6   TC4   TC7   TC8   h2
## energy              3  0.90                                           0.83
## loudness            5  0.88                                           0.77
## acousticness        8 -0.71                                           0.63
## popularity         15        0.82                                     0.75
## followers          14        0.80                                     0.68
## danceability        2              0.70                         -0.31 0.67
## speechiness         7              0.69                          0.31 0.63
## total_releases     16        0.39  0.48                               0.50
## adv_spending       18                    0.78                         0.63
## mstreams           17                    0.72                         0.62
## key                 4                          0.78                   0.63
## mode                6                         -0.74                   0.60
## trackPopularity     1                                0.81             0.69
## duration_ms        13        0.37                   -0.39             0.46
## tempo              12                                      0.72       0.59
## instrumentalness    9             -0.35              0.30  0.47       0.42
## valence            11  0.34                               -0.46       0.53
## liveness           10                                            0.91 0.84
##                    u2 com
## energy           0.17 1.1
## loudness         0.23 1.0
## acousticness     0.37 1.5
## popularity       0.25 1.2
## followers        0.32 1.2
## danceability     0.33 1.6
## speechiness      0.37 1.7
## total_releases   0.50 2.9
## adv_spending     0.37 1.1
## mstreams         0.38 1.3
## key              0.37 1.1
## mode             0.40 1.2
## trackPopularity  0.31 1.1
## duration_ms      0.54 4.1
## tempo            0.41 1.4
## instrumentalness 0.58 2.9
## valence          0.47 3.7
## liveness         0.16 1.0
## 
##                        TC1  TC2  TC3  TC5  TC6  TC4  TC7  TC8
## SS loadings           2.34 1.82 1.54 1.28 1.18 1.12 1.09 1.10
## Proportion Var        0.13 0.10 0.09 0.07 0.07 0.06 0.06 0.06
## Cumulative Var        0.13 0.23 0.32 0.39 0.45 0.52 0.58 0.64
## Proportion Explained  0.20 0.16 0.13 0.11 0.10 0.10 0.10 0.10
## Cumulative Proportion 0.20 0.36 0.50 0.61 0.71 0.81 0.90 1.00
## 
##  With component correlations of 
##       TC1   TC2   TC3   TC5   TC6   TC4   TC7   TC8
## TC1  1.00 -0.01  0.08 -0.01  0.02  0.01 -0.03  0.02
## TC2 -0.01  1.00  0.07  0.06  0.01  0.00  0.05  0.00
## TC3  0.08  0.07  1.00  0.05  0.02  0.03  0.05 -0.01
## TC5 -0.01  0.06  0.05  1.00  0.01  0.02 -0.03 -0.02
## TC6  0.02  0.01  0.02  0.01  1.00  0.03 -0.03  0.02
## TC4  0.01  0.00  0.03  0.02  0.03  1.00 -0.05 -0.07
## TC7 -0.03  0.05  0.05 -0.03 -0.03 -0.05  1.00  0.05
## TC8  0.02  0.00 -0.01 -0.02  0.02 -0.07  0.05  1.00
## 
## Mean item complexity =  1.7
## Test of the hypothesis that 8 components are sufficient.
## 
## The root mean square of the residuals (RMSR) is  0.09 
##  with the empirical chi square  9473.51  with prob &lt;  0 
## 
## Fit based upon off diagonal values = 0.56</code></pre>
<p>The component correlations indicate that the factors might indeed be correlated, so oblique rotation might actually be more appropriate in this case.</p>
</div>
<div id="creating-new-variables" class="section level3">
<h3><span class="header-section-number">7.2.4</span> Creating new variables</h3>
<p>Once we have decided on the final model, we can calculate the new variables as the weighted sum of the variables that form a factor. This means, we estimate a person’s score on a factor based on their scores on the items that constitute the measurement scales. These scores are also referred to as the <strong>factor scores</strong>. Because we have used the <code>scores = TRUE</code> argument in the previous command, the factor scores have already been created for us. By default, R uses the regression method to compute the factor scores, which controls for differences in the units of measurement. You can access the residuals as follows:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(pc4<span class="op">$</span>scores)</code></pre>
<pre><code>##           TC1        TC2        TC3         TC5         TC6        TC4
## 1  0.13063795  0.4269322  0.6272918  0.41173286 -0.10906147 -1.1849019
## 2 -0.05623179  0.6684125 -0.4996449 -0.03811335  0.04263251  0.8481708
## 3  0.57621785 -0.2878335 -0.8895283 -0.04386124 -0.13199630 -1.3318263
## 4  0.79922433 -0.1759615 -0.5195045 -0.18203201  1.58508901  0.8541294
## 5  0.35639950  2.4201409  0.3125971  0.20377325 -1.32790788 -0.6080293
## 6 -0.48712091  2.4616652  2.1917040  0.43070247  1.52550595  0.6149019
##          TC7         TC8
## 1  1.1349130 -0.09281764
## 2 -1.6389074 -0.60115458
## 3  2.1756119 -0.36288187
## 4 -1.2870368 -0.01058945
## 5 -0.7856359  0.50216754
## 6 -0.1420794  0.25098862</code></pre>
<p>We can also use the <code>cbind()</code> function to add the computed factor scores to the existing data set:</p>
<pre class="sourceCode r"><code class="sourceCode r">spotify_data &lt;-<span class="st"> </span><span class="kw">cbind</span>(spotify_data, pc4<span class="op">$</span>scores)</code></pre>
<p>This way, it is easier to use the new variables in subsequent analysis (e.g., t-tests, regression, ANOVA, cluster analysis).</p>
</div>
</div>
<div id="reliability-analysis" class="section level2">
<h2><span class="header-section-number">7.3</span> Reliability analysis</h2>
<p>When you are using multi-item scales to measure a latent construct (e.g., the output from the PCA above), it is useful to check the reliability of your scale. Reliability means that our items should consistently reflect the construct that they are intended to measure. In other words, individual items should produce results consistent with the overall scale. This means that for a scale to be reliable, the score of a person on one half of the items should be similar to the score derived based on the other half of the items (split-half reliability). The problem is that there are several ways in which data can be split. A measure that reflects this underlying intuition is <strong>Cronbach’s alpha</strong>, which is approximately equal to the average of all possible split-half reliabilities. It is computed as follows:</p>
<p><span class="math display" id="eq:calpha">\[\begin{equation} 
\alpha=\frac{N^2\overline{Cov}}{\sum{s^2_{item}}+\sum{Cov_{item}}}
\tag{7.8}
\end{equation}\]</span></p>
<p>The share of the items common variance (inter-correlation) in the total variance is supposed to be as high as possible across all items. The thresholds are as follows:</p>
<ul>
<li>&gt;0.7 reasonable for practical application/explorative research</li>
<li>&gt;0.8 necessary for fundamental research</li>
<li>&gt;0.9 desirable for applied research</li>
</ul>
<p>To see if the subscales that were derived from the previous PCA exhibit a sufficient degree of reliability, we first create subsets of our data set that contain the respective items for each of the factors (we use the results from the oblimin rotation here):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#loud &lt;- spotify_data[,c(6,7,10,13,14,15,18)]</span>
<span class="co">#trending &lt;- spotify_data[,c(1,3,4,5,12,16,20,21)]</span>
<span class="co">#dancefloor &lt;- spotify_data[,c(8,11,17)]</span>
<span class="co">#affluent &lt;- spotify_data[,c(2,9,19,22,23)]</span></code></pre>
<p>Now we can use the <code>alpha()</code> function from the <code>psych</code> package to test the reliability. Note that the <code>keys</code> argument may be used to indicate reverse coded items. In the example below, the second item of the “statistics_fear” factor is reverse coded as indicated by the <code>-1</code>, meaning that it is phrased in a “positive” way, while the remaining items belonging to this factor are phrased in a “negative” way. This is often done to check if respondents are giving consistent answers.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#psych::alpha(computer_fear)</span>
<span class="co">#psych::alpha(statistics_fear, keys=c(1,-1,1,1,1,1,1,1))</span>
<span class="co">#psych::alpha(math_fear)</span>
<span class="co">#psych::alpha(peer_evaluation)</span></code></pre>
<p>The above output would lead us to conclude that the fear of computers, fear of statistics and fear of maths subscales of the RAQ all had sufficiently high reliabilities (i.e., Cronbach’s alpha &gt; 0.70). However, the fear of negative peer evaluation subscale had relatively low reliability (Cronbach’s alpha = 0.57). As the output under “Reliability if an item is dropped” suggests, the alpha score would also not increase if an item was dropped from the scale.</p>
<p>As another example, consider the multi-item scale from the statistical ability questionnaire.</p>
<pre class="sourceCode r"><code class="sourceCode r">test_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/IMSMWU/Teaching/master/MRDA2017/survey2017.dat&quot;</span>, 
                        <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="kw">head</span>(test_data)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["startdate"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["enddate"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["ipaddress"],"name":[3],"type":["fctr"],"align":["left"]},{"label":["duration"],"name":[4],"type":["int"],"align":["right"]},{"label":["experience"],"name":[5],"type":["int"],"align":["right"]},{"label":["theory_ht"],"name":[6],"type":["int"],"align":["right"]},{"label":["theory_anova"],"name":[7],"type":["int"],"align":["right"]},{"label":["theory_reg"],"name":[8],"type":["int"],"align":["right"]},{"label":["theory_fa"],"name":[9],"type":["int"],"align":["right"]},{"label":["pract_ht"],"name":[10],"type":["int"],"align":["right"]},{"label":["pract_anova"],"name":[11],"type":["int"],"align":["right"]},{"label":["pract_reg"],"name":[12],"type":["int"],"align":["right"]},{"label":["pract_fa"],"name":[13],"type":["int"],"align":["right"]},{"label":["overall_knowledge"],"name":[14],"type":["int"],"align":["right"]},{"label":["multi_1"],"name":[15],"type":["int"],"align":["right"]},{"label":["multi_2"],"name":[16],"type":["int"],"align":["right"]},{"label":["multi_3"],"name":[17],"type":["int"],"align":["right"]},{"label":["multi_4"],"name":[18],"type":["int"],"align":["right"]},{"label":["overall_100"],"name":[19],"type":["int"],"align":["right"]},{"label":["prior_SPSS"],"name":[20],"type":["int"],"align":["right"]},{"label":["prior_R"],"name":[21],"type":["int"],"align":["right"]},{"label":["prior_Stata"],"name":[22],"type":["int"],"align":["right"]},{"label":["prior_Excel"],"name":[23],"type":["int"],"align":["right"]},{"label":["prior_SAS"],"name":[24],"type":["int"],"align":["right"]},{"label":["software_preference"],"name":[25],"type":["int"],"align":["right"]},{"label":["future_importance"],"name":[26],"type":["int"],"align":["right"]},{"label":["gender"],"name":[27],"type":["int"],"align":["right"]},{"label":["country"],"name":[28],"type":["int"],"align":["right"]},{"label":["group"],"name":[29],"type":["int"],"align":["right"]},{"label":["lat"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["long"],"name":[31],"type":["dbl"],"align":["right"]}],"data":[{"1":"04.09.2017 21:03","2":"04.09.2017 21:05","3":"188.23.190.194","4":"136","5":"3","6":"2","7":"2","8":"2","9":"2","10":"3","11":"3","12":"3","13":"3","14":"2","15":"2","16":"2","17":"4","18":"3","19":"25","20":"1","21":"1","22":"1","23":"5","24":"1","25":"5","26":"4","27":"1","28":"1","29":"1","30":"48.30000","31":"16.350006"},{"1":"04.09.2017 21:07","2":"04.09.2017 21:12","3":"93.10.250.2","4":"297","5":"3","6":"1","7":"3","8":"3","9":"3","10":"1","11":"1","12":"1","13":"1","14":"2","15":"2","16":"2","17":"2","18":"4","19":"15","20":"1","21":"1","22":"1","23":"4","24":"1","25":"5","26":"4","27":"2","28":"2","29":"1","30":"43.71671","31":"7.366699"},{"1":"04.09.2017 21:09","2":"04.09.2017 21:13","3":"91.0.18.86","4":"237","5":"3","6":"2","7":"3","8":"3","9":"1","10":"1","11":"1","12":"1","13":"1","14":"2","15":"3","16":"3","17":"3","18":"3","19":"30","20":"1","21":"1","22":"1","23":"2","24":"1","25":"5","26":"4","27":"2","28":"2","29":"2","30":"50.91330","31":"6.815201"},{"1":"04.09.2017 21:14","2":"04.09.2017 21:23","3":"37.116.255.55","4":"579","5":"1","6":"3","7":"3","8":"3","9":"2","10":"3","11":"3","12":"2","13":"2","14":"3","15":"4","16":"3","17":"3","18":"2","19":"65","20":"1","21":"1","22":"1","23":"3","24":"1","25":"3","26":"4","27":"2","28":"2","29":"1","30":"45.50000","31":"11.399994"},{"1":"04.09.2017 21:25","2":"04.09.2017 21:30","3":"178.165.131.208","4":"290","5":"1","6":"3","7":"3","8":"2","9":"2","10":"5","11":"5","12":"4","13":"3","14":"3","15":"4","16":"3","17":"4","18":"2","19":"70","20":"3","21":"1","22":"1","23":"3","24":"1","25":"1","26":"4","27":"2","28":"1","29":"1","30":"48.20869","31":"16.240707"},{"1":"04.09.2017 21:42","2":"04.09.2017 21:46","3":"212.28.68.81","4":"205","5":"3","6":"2","7":"3","8":"3","9":"1","10":"1","11":"1","12":"1","13":"1","14":"1","15":"3","16":"3","17":"2","18":"4","19":"0","20":"1","21":"1","22":"1","23":"1","24":"1","25":"5","26":"4","27":"2","28":"2","29":"1","30":"47.00560","31":"28.857498"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The four variables “multi_1” - “multi_4” represent the multi-item scales. We can test the reliability of the scale using the <code>alpha()</code> function (item 4 was reverse coded, hence the “-1” in the <code>keys</code> vector):</p>
<pre class="sourceCode r"><code class="sourceCode r">psych<span class="op">::</span><span class="kw">alpha</span>(test_data[,<span class="kw">c</span>(<span class="st">&quot;multi_1&quot;</span>,<span class="st">&quot;multi_2&quot;</span>,<span class="st">&quot;multi_3&quot;</span>,<span class="st">&quot;multi_4&quot;</span>)], <span class="dt">keys=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>))</code></pre>
<pre><code>## 
## Reliability analysis   
## Call: psych::alpha(x = test_data[, c(&quot;multi_1&quot;, &quot;multi_2&quot;, &quot;multi_3&quot;, 
##     &quot;multi_4&quot;)], keys = c(1, 1, 1, -1))
## 
##   raw_alpha std.alpha G6(smc) average_r  S/N  ase mean   sd median_r
##       0.22      0.27    0.71     0.084 0.37 0.14  2.8 0.58     0.05
## 
##  lower alpha upper     95% confidence boundaries
## -0.06 0.22 0.51 
## 
##  Reliability if an item is dropped:
##         raw_alpha std.alpha G6(smc) average_r   S/N alpha se  var.r med.r
## multi_1     -0.69     -0.61    0.39     -0.14 -0.38    0.377 0.6413 -0.61
## multi_2     -0.85     -0.77    0.23     -0.17 -0.43    0.412 0.5494 -0.59
## multi_3     -0.57     -0.47    0.49     -0.12 -0.32    0.358 0.6858 -0.59
## multi_4      0.91      0.91    0.88      0.77  9.95    0.022 0.0058  0.78
## 
##  Item statistics 
##          n raw.r std.r r.cor r.drop mean  sd
## multi_1 55  0.86  0.87  0.87   0.62  2.7 1.0
## multi_2 55  0.89  0.90  0.95   0.70  2.6 1.0
## multi_3 55  0.83  0.83  0.79   0.54  2.5 1.1
## multi_4 55 -0.34 -0.36 -0.73  -0.65  3.2 1.1
## 
## Non missing response frequency for each item
##            1    2    3    4    5 miss
## multi_1 0.11 0.36 0.25 0.25 0.02    0
## multi_2 0.11 0.42 0.25 0.18 0.04    0
## multi_3 0.18 0.38 0.22 0.20 0.02    0
## multi_4 0.04 0.31 0.16 0.40 0.09    0</code></pre>
<p>Since the scale exhibits a sufficient degree of reliability, we can compute the new variable as the average score on these items. However, before doing this, we need to recode the reverse coded variable in the appropriate way. It is easy to recode the reverse coded item to be in line with the remaining items on the dimension using the <code>recode()</code> function from the <code>car</code> package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)
test_data<span class="op">$</span>multi_<span class="dv">4</span>_rec =<span class="st"> </span><span class="kw">recode</span>(test_data<span class="op">$</span>multi_<span class="dv">4</span>, <span class="st">&quot;1=5; 2=4; 3=3; 4=2; 5=1&quot;</span>)</code></pre>
<p>Now we can compute the new variable as the average score of the four items:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)
test_data<span class="op">$</span>new_variable =<span class="st"> </span>(test_data<span class="op">$</span>multi_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>test_data<span class="op">$</span>multi_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>test_data<span class="op">$</span>multi_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>test_data<span class="op">$</span>multi_<span class="dv">4</span>_rec) <span class="op">/</span><span class="st"> </span><span class="dv">4</span></code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
